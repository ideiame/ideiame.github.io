
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
<link rel="stylesheet"
    type="text/css"
    href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"
    data-cfasync="false"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NV80WM9HT0"></script>
<script>
    // Reads the value of a cookie by name or returns empty string
    function getCookie(name) {
        var b = document.cookie.match('(^|[^;]+)\\s*' + name + '\\s*=\\s*([^;]+)');
        return b ? b.pop() : '';
    }

    // Actually starting analytics up
    function addAnalytics() {
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());
        gtag('config', 'G-NV80WM9HT0');
    }

    // Waiting for the load event
    window.addEventListener("load", function () {
        // Reading "cookieconsent_status" cookie
        const cookieConsent = getCookie('cookieconsent_status');

        // Start analytics if user consented or did not deny
        if (cookieConsent === 'allow' || cookieConsent === '') {
            addAnalytics();
        }

        // Initialise cookie consent banner
        window.cookieconsent.initialise({
            "palette": {
                "popup": {
                    "background": "#efefef",
                    "text": "#404040"
                },
                "button": {
                    "background": "#8ec760",
                    "text": "#ffffff"
                }
            },
            "type": "opt-out",
            "content": {
                "allow": "Approve",
                "dismiss": "Approve",
                "deny": "Reject"
            },
            // Reload the page on user choice to make sure cookie is set
            onStatusChange: function (status, chosenBefore) {
                location.reload();
            }
        })
    });
</script>

    <script async
src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1171230226237014"
crossorigin="anonymous"></script>

    <meta charset="utf-8">
    <title>PGConf Brasil</title>
    <meta name="description" content="Na minha palestra da PGConf Brasil 2022 falei sobre a "Vida Zen no Terminal". Então resolvi compartilhar aqui um pouco dos aprendizados que compartilhei poi...">
    <meta name="author" content="Jônatas Davi Paganini">

    <!-- Immediate dark mode application to prevent flash -->
    <script>
      (function() {
        // Force dark mode for testing purposes
        const savedTheme = localStorage.getItem('theme');
        const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (savedTheme === null && prefersDarkMode)) {
          document.documentElement.classList.add('dark-mode');
          document.write('<style>body,html{background-color:#121212!important;color:#f0f2f5!important;}div{background-color:transparent!important;}</style>');
        }
      })();
    </script>

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Modern stylesheet links -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&family=Poppins:wght@400;500;600&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <!-- GitHub-style syntax highlighting -->
    <link href="/css/rouge-github.css" rel="stylesheet">
    <link href="/css/nimbus-pygments.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">
    <link href="/css/disqus-dark.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <!-- Modern JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    
    <!-- GitHub-style code block enhancement -->
    <script src="/js/github-code-blocks.js"></script>
    
    <div id="fb-root"></div>

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
  <script type="text/javascript" language="javascript" charset="utf-8">
// <![CDATA[
    addEventListener('load', function (event) {
      var agent=navigator.userAgent.toLowerCase();
      var links = document.getElementsByTagName('a');
      var regex = new RegExp('^'+window.location.protocol + '//' + window.location.hostname);

      for (var i = 0, linksLength = links.length; i < linksLength; i++) {
        if ( ! links[i].href.match(regex)) {
           links[i].setAttribute('target', '_blank');
       }
     }

    }, false);
// ]]>
</script>
</head>
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v2.5&appId=138593009602387";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand py-0" href="/">
          <img class="rounded-circle" alt="ideiame logo" src="/images/ideiame.png">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarMain">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle py-1" href="#" id="pagesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
               Ideia.me 
              </a>
              <ul class="dropdown-menu shadow-sm" aria-labelledby="pagesDropdown">
                <li><a class="dropdown-item" href="/archive">Archive</a></li>
                <li><a class="dropdown-item" href="/talks">Talks</a></li>
                <li><a class="dropdown-item" href="/categories">Categories</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="https://www.linkedin.com/in/jonatasdp"><i class="bi bi-linkedin"></i> Linkedin</a></li>
                <li><a class="dropdown-item" href="https://github.com/jonatas"><i class="bi bi-github"></i> Github</a></li>
                <li><a class="dropdown-item" href="https://twitter.com/jonatasdp"><i class="bi bi-twitter"></i> Twitter</a></li>
                <li><a class="dropdown-item" href="https://instagram.com/jonatasdp"><i class="bi bi-instagram"></i> Instagram</a></li>
                <li><a class="dropdown-item" href="https://www.youtube.com/user/jonatasdp"><i class="bi bi-youtube"></i> Youtube</a></li>
              </ul>
            </li>
          </ul>
          
          <div class="d-none d-md-block page-title-nav me-auto ms-2">
            PGConf Brasil
          </div>
          
          <div class="form-check form-switch d-flex align-items-center ms-auto">
            <input class="form-check-input me-1" type="checkbox" id="darkModeToggle">
            <label class="form-check-label text-light" for="darkModeToggle">
              <i class="bi bi-moon-stars"></i>
            </label>
          </div>
        </div>
      </div>
    </nav>
    
    <div class="container content-container mt-5 pt-5">
      

<div class="article-wrapper">
  <div class="article-header">
    <h1>PGConf Brasil</h1>
    <div class="article-meta">
      <span><i class="bi bi-calendar3"></i> August 29, 2022</span>
      <span class="separator">•</span>
      
  
  
    <span class="reading-time" title="Estimated read time">
      <i class="bi bi-clock"></i> 28 min read
    </span>
  
 
      
      
      <span class="separator">•</span>
      <span>
        <i class="bi bi-folder"></i> 
        
          <a href="#terminal-ref" class="text-muted">terminal</a>, 
        
          <a href="#shell-ref" class="text-muted">shell</a>, 
        
          <a href="#unix-ref" class="text-muted">unix</a>, 
        
          <a href="#opensource-ref" class="text-muted">opensource</a>, 
        
          <a href="#postgresql-ref" class="text-muted">postgresql</a>, 
        
          <a href="#talk-ref" class="text-muted">talk</a>
        
      </span>
      
    </div>
  </div>
  
  <div class="article-content">
    <p>Na minha palestra da <a href="https://www.pgconf.com.br/2022/">PGConf Brasil 2022</a>.
falei sobre a “Vida Zen no Terminal”. Então resolvi compartilhar aqui um pouco
dos aprendizados que compartilhei pois são dicas práticas que podem ser úteis
para quem adora o terminal, ou gostaria de iniciar.</p>

<p>Aqui vai a gravação da palestra:</p>

<div class="video-container">
       <iframe width="560" height="420" frameborder="0" allowfullscreen="" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" src="https://www.youtube.com/embed/MzV6S_72E2g?color=white&amp;theme=light">
       </iframe>
    </div>

<p>Bom, eu trabalho com programação desde que meus 17 anos de idade.</p>

<p>Quando eu comecei, tudo que eu tinha era o terminal! Então de alguma forma, a
vida sem interface gráfica parecia muito mais fácil e focada do que nos dias
atuais.</p>

<p>O terminal é aquela tela sem graça que não faz nada que você não peça. Ela não
interage com você se você não interagir. Ela não te notifica. Ela não te distrai.
Então, essa é a parte Zen do terminal. Você é o monge da montanha encantada e só
depende de você para meditar e concentrar naquilo que precisa fazer.</p>

<p>Eu gosto muito da ideia de concentrar e no fim isso me leva a trabalhar menos.</p>

<p>Menos horas na frente do computador e mais liberdade pra estudar e evoluir.
Por isso é importante aprender a viver longe do ambiente de distrações ou pelo
menos criar um espaço sem distrações para o foco total em programar.</p>

<p>Sou muito feliz ter usado sistemas baseados em unix desde o início da minha
carreira e de fato nunca consegui literalmente me livrar do terminal.</p>

<p>Resolvi organizar esse material para mostrar as coisas que percebi durante anos
pareando e ajudando pessoas a se distraírem menos no terminal :D</p>

<p>Meu objetivo aqui é mostrar dicas relacionadas a usar o terminal e ferramentas
que podem te ajudar a ser feliz por aqui.</p>

<p>O foco central dessa sessão é mostrar o psql, mas também iremos ir e voltar
em várias outras ferramentas.</p>

<h2 id="terminal-intro">Terminal intro</h2>

<p>Vamos começar com um breve introdução ao terminal. Eu não vou ficar fazendo um
tutorial de cada detalhe do terminal nem contando a história dele mas gostaria de
mostrar algumas coisas que vão te fazer entender melhor o fluxo de trabalho.</p>

<p>Então, a primeira coisa, é entender o cursor. Quando você entra, você tem que
sempre localizar onde ele está. Geralmente ele está piscando.
E seu foco se move juntamente com o cursor. O cursor sempre é a última informação
da tela, aparecendo mais a baixo e o que vem depois dele é sempre o espaço restante da tela.</p>

<p>O terminal também é conhecido como <strong>linha de comando</strong> pois é ali que você
interage com o computador da maneira mais rudimentar. A linha de comando nada
mais é que um REPL -&gt; Read, Eval e Print Line, ou seja, ele lê a informação que
você digita quando você digita um comando e dá um enter, então valida e compila,
e imprime de volta o resultado do comando.</p>

<p>Então vamos começar descobrindo quem sou eu com o <code class="language-plaintext highlighter-rouge">whoami</code> que é o primeiro
comando que vocês irão aprender :D</p>

<p>Então, <code class="language-plaintext highlighter-rouge">whoami</code> retornou esse nome aí pra mim, dizendo meu nome. Agora, já
complicando um pouco mais, vou introduzir aqui um comando echo que é um comando
que basicamente imprime o que eu estou pedindo:</p>

<pre><code class="language-fish">echo (whoami) você está no seu (hostname)
jonatasdp você está no seu MacBook-Pro
</code></pre>

<p>Como vocês podem ver, eu usei essa sintaxe entre parenteses e basicamente ela
executou uma linha de comando aninhada e o returno foi injetado no código.</p>

<p>Aí, nesse momento, você deve já usa o terminal deve estar pensando, esse cara
está maluco, já confundindo a cabeça das pessoas navegando entre multiplos
shells. Então como vocês podem ver no topo do meu terminal, eu troquei meu
terminal pra usar o fish ao invés do bash. Bash é o terminal padrão, mas ele é
muito rudimentar e eu acabo usando mais o fish.</p>

<p>Para não complicar muito essa palestra, irei usar o bash e facilitar a vida de
vocês, mas se você nao adotou ainda um, eu gosto muito do fish, quando alguma
coisa não dá certo, eu entro dentro do shell novamente.</p>

<p>Lembrando que o terminal é uma matrix, então você pode ter várias inceptions
aqui. Você pode abrir um <a href="https://fishshell.com">fish shell</a>,
e dentro dele abrir um bash e aí abrir um outro bash ou fish dentro 
da sessão que você já está rodando.</p>

<p>Você pode até acabar em outro computador executando coisas em uma cloud se você
não perceber onde está e tudo isso torna as coisas mais difíceis se você não
prestar atenção.</p>

<p>Existem várias ferramentas que permitem alterar esse comportamento e também
existem aplicativos no terminal que permitem você navegar com o cursor para
lugares diferentes. A variável <code class="language-plaintext highlighter-rouge">PS1</code> pode te ajudar caso queira alterar esse
comportamento.</p>

<h3 id="ergonomia-dos-comandos">Ergonomia dos comandos</h3>

<p>Um comando geralmente é uma instrução que o terminal irá processar. Geralmente
trata-se de outro software que pode ser chamado pela linha de comando.</p>

<p>O comando geralmente tem a seguinte sintaxe:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;comando&gt; &lt;*argumentos&gt;
</code></pre></div></div>

<p>Cada comando ocupa uma linha e se você quiser fazer vários comandos na mesma
linha, é possível com <code class="language-plaintext highlighter-rouge">;</code> para dividir eles. Ou seja:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"olá mundo."</span>
<span class="nb">echo</span> <span class="s2">"seja bem vindo."</span>
</code></pre></div></div>
<p>é o mesmo que:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"olá mundo."</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">"seja bem vindo."</span>
</code></pre></div></div>

<p>Os comandos podem também conter argumentos especiais, que geralmente começam com
um traço ou o sinal de menos <code class="language-plaintext highlighter-rouge">-</code> seguido de uma letra, ou dois traços e uma
palavra.</p>

<p>Então, se eu quisesse unir as linhas anteriores, pensaria, hmm, só preciso usar
o <code class="language-plaintext highlighter-rouge">\n</code> ali e consigo usar uma única linha no echo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"olá mundo.</span><span class="se">\n</span><span class="s2">seja bem vindo."</span>
</code></pre></div></div>

<p>Mas infelizmente o comando não irá quebrar linha naturalmente. Nesse caso é
necessário que o <code class="language-plaintext highlighter-rouge">echo</code> tenha um parâmetro especial <code class="language-plaintext highlighter-rouge">-e</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"olá mundo.</span><span class="se">\n</span><span class="s2">seja bem vindo."</span>
</code></pre></div></div>

<p>No bash, também é possível reusar informações através do uso de variáveis.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">nome</span><span class="o">=</span><span class="s1">'fulano'</span>
<span class="nb">echo</span> <span class="s2">"bem vindo </span><span class="nv">$nome</span><span class="s2">"</span>
</code></pre></div></div>
<p>E também é possível calcular expressões matemáticas com o comando <code class="language-plaintext highlighter-rouge">expr</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">A</span><span class="o">=</span>1<span class="p">;</span> <span class="nv">B</span><span class="o">=</span>2<span class="p">;</span> <span class="nb">echo </span>A + B <span class="o">=</span> <span class="si">$(</span><span class="nb">expr</span> <span class="nv">$A</span> + <span class="nv">$B</span><span class="si">)</span>
</code></pre></div></div>

<p>O comando também pode conversar com outros comandos através dos operadores. Por
exemplo, o <code class="language-plaintext highlighter-rouge">&gt;</code> permite enviar os dados para uma saída diferente da saída da tela.</p>

<p>O <code class="language-plaintext highlighter-rouge">echo</code> imprime para tela, então no exemplo abaixo estou enviando o conteúdo do
resultado para o arquivo <strong>ola.txt</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'olá mundo'</span> <span class="o">&gt;</span> ola.txt
</code></pre></div></div>

<p>O <code class="language-plaintext highlighter-rouge">&gt;&gt;</code> permite adicionar mais dados no mesmo arquivo enquanto o <code class="language-plaintext highlighter-rouge">&gt;</code> sempre
recria o arquivo, mesmo que ele exista.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'bem vindo'</span> <span class="o">&gt;&gt;</span> ola.txt
</code></pre></div></div>

<p>Agora, o arquivo tem duas linhas:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'bem vindo'</span> <span class="o">&gt;&gt;</span> ola.txt
</code></pre></div></div>

<p>Ou pode receber informações de outros comandos com o <code class="language-plaintext highlighter-rouge">|</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>ola.txt | <span class="nb">grep </span>vindo
</code></pre></div></div>

<p>O comando irá filtrar apenas as linhas do resultado do <code class="language-plaintext highlighter-rouge">cat</code> que contenham a
palavra <code class="language-plaintext highlighter-rouge">vindo</code>.</p>

<h3 id="atalhos-importantes">Atalhos importantes</h3>

<p>Pra você sobreviver na linha de comando é necessário aprender atalhos para
ganhar tempo. Isso não quer dizer que você não consiga viver sem, mas eles vão
te dar mais liberdade e fluidez para seguir uma vida mais sana.</p>

<h3 id="terminal-readline">Terminal readline</h3>

<p>Esse programa que roda quando você digita no terminal, geralmente é o
<a href="https://tiswww.case.edu/php/chet/readline/rltop.html">readline</a> e ele suporta
uma série de atalhos que podem ajudar a editar os comandos mais rápidos.</p>

<p>Atalhos de navegação:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ctrl-a</code> - move cursor para o começo da linha</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl-e</code> - move cursor para o fim da linha</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl-b</code> - move cursor para trás</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl-f</code> - move cursor  para frente</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl ←</code> ou <code class="language-plaintext highlighter-rouge">esc-b</code> -  volta uma palavra</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl →</code> ou <code class="language-plaintext highlighter-rouge">esc-f</code> ou <code class="language-plaintext highlighter-rouge">esc-l</code> - avança uma palavra</li>
</ul>

<p>Atalhos de edição:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ctrl-r</code> - Usa o histórico de forma reversa</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl-d</code> - remove uma letra</li>
  <li><code class="language-plaintext highlighter-rouge">ctrl-w</code> - remove uma palavra</li>
  <li><code class="language-plaintext highlighter-rouge">esc-backspace</code> - apaga palavra</li>
</ul>

<p>Também existem muitas variáveis úteis que se tornam atalhos importantes para
navegar e resolver problemas mais rápidos na linha de comando:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">!$</code> último argumento da linha anterior</li>
  <li><code class="language-plaintext highlighter-rouge">!!</code> último comando</li>
  <li><code class="language-plaintext highlighter-rouge">$OLDPWD</code> último diretorio</li>
  <li><code class="language-plaintext highlighter-rouge">$PATH</code> diretórios oficiais para buscar comandos</li>
  <li><code class="language-plaintext highlighter-rouge">$USER</code> nome do usuário</li>
  <li><code class="language-plaintext highlighter-rouge">$HOME</code> caminho para o diretório do usuário</li>
</ul>

<h2 id="process-matrix">Process matrix</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ctrl-z</code> envia processo para background</li>
  <li><code class="language-plaintext highlighter-rouge">fg</code> resgata processo em background</li>
  <li><code class="language-plaintext highlighter-rouge">echo $0</code> verifica qual shell está usando</li>
</ul>

<h2 id="history">history</h2>

<p>O history é muito legal para encontrar comandos que você digitou no passado e
também re-executar eles com facilidade.</p>

<table>
  <tbody>
    <tr>
      <td>history</td>
      <td>grep psql</td>
    </tr>
  </tbody>
</table>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!&lt;numero-do-comando&gt;
</code></pre></div></div>

<p>Ou usar o <code class="language-plaintext highlighter-rouge">&lt;ctrl-r&gt;</code> e buscar pelo comando.</p>

<h3 id="man">man</h3>

<p>man é o manual de tudo na linha de comando. Então se você precisa entender a
especificação de um determinado comando é a forma mais rápida de aprender e
verificar como ele funciona.</p>

<h3 id="tldr">tldr</h3>

<p>Eu gosto muito do tldr pq eu geralmente não lembro dos comandos e eu só preciso
de um exemplo pra seguir fazendo o que eu preciso, então, o TLDR que é um
acronimo para Too Long Don’t Read, é super útil para me dar o exemplo certo na
hora certa.</p>

<p>Exemplo buscando por exemplos do <code class="language-plaintext highlighter-rouge">sed</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> tldr <span class="nb">sed

sed

</span>Edit text <span class="k">in </span>a scriptable manner.
More information: &lt;https://ss64.com/osx/sed.html&gt;.

- Replace the first occurrence of a string <span class="k">in </span>a file, and print the result:
    <span class="nb">sed</span> <span class="s1">'s/find/replace/'</span> filename

- Replace all occurrences of an extended regular expression <span class="k">in </span>a file:
    <span class="nb">sed</span> <span class="nt">-E</span> <span class="s1">'s/regular_expression/replace/g'</span> filename

- Replace all occurrences of a string <span class="o">[</span>i]n a file, overwriting the file <span class="o">(</span>i.e. <span class="k">in</span><span class="nt">-place</span><span class="o">)</span>:
    <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">''</span> <span class="s1">'s/find/replace/g'</span> filename

- Replace only on lines matching the line pattern:
    <span class="nb">sed</span> <span class="s1">'/line_pattern/s/find/replace/'</span> filename

- Print only text between n-th line till the next empty line:
    <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'line_number,/^$/p'</span> filename

- Apply multiple find-replace expressions to a file:
    <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s/find/replace/'</span> <span class="nt">-e</span> <span class="s1">'s/find/replace/'</span> filename

- Replace separator <span class="sb">`</span>/<span class="sb">`</span> by any other character not used <span class="k">in </span>the find or replace patterns, e.g. <span class="sb">`</span><span class="c">#`:</span>
    <span class="nb">sed</span> <span class="s1">'s#find#replace#'</span> filename

- <span class="o">[</span>d]elete the line at the specific line number <span class="o">[</span>i]n a file, overwriting the file:
    <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">''</span> <span class="s1">'line_numberd'</span> filename
</code></pre></div></div>

<p>Bem mais objetivo que ler o <a href="https://linux.die.net/man/1/sed">manual do sed</a>.</p>

<h2 id="gexec-pra-rodar-comandos-a-partir-da-query-anterior"><code class="language-plaintext highlighter-rouge">\gexec</code> pra rodar comandos a partir da query anterior</h2>

<p>Para reutilizar comandos sql gerados pelo próprio sql então vamos começar
gerando uns dados só pra se divertir.</p>

<p>Imagina que eu posso digitar:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>
<p>Mas também posso digitar uma string com sql dentro do select.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="s1">'SELECT 1'</span><span class="p">;</span>
</code></pre></div></div>
<p>Agora, se eu quiser fazer algo mais dinâmico, posso gerar várias linhas:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="n">a</span> <span class="k">from</span> <span class="n">generate_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="n">a</span><span class="p">;</span>
</code></pre></div></div>

<p>E gerar comandos SQLs a partir dessa sequência:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="s1">'select '</span><span class="o">||</span><span class="n">a</span> <span class="k">from</span> <span class="n">generate_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="n">a</span><span class="p">;</span>
</code></pre></div></div>

<p>Pra pegar esse último output e executar como SQL é só usar o <code class="language-plaintext highlighter-rouge">\gexec</code>.
Exemplo completo:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">db</span><span class="o">=#</span> <span class="k">select</span> <span class="s1">'select '</span><span class="o">||</span><span class="n">a</span> <span class="k">from</span> <span class="n">generate_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="n">a</span><span class="p">;</span>
<span class="err">┌───────────┐</span>
<span class="err">│</span> <span class="o">?</span><span class="k">column</span><span class="o">?</span>  <span class="err">│</span>
<span class="err">├───────────┤</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">1</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">2</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">3</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">4</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">5</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">6</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">7</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">8</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">9</span>  <span class="err">│</span>
<span class="err">│</span> <span class="k">select</span> <span class="mi">10</span> <span class="err">│</span>
<span class="err">└───────────┘</span>
<span class="p">(</span><span class="mi">10</span> <span class="k">rows</span><span class="p">)</span>

<span class="n">db</span><span class="o">=#</span> <span class="err">\</span><span class="n">gexec</span>
<span class="err">┌──────────┐</span>
<span class="err">│</span> <span class="o">?</span><span class="k">column</span><span class="o">?</span> <span class="err">│</span>
<span class="err">├──────────┤</span>
<span class="err">│</span>        <span class="mi">1</span> <span class="err">│</span>
<span class="err">└──────────┘</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>

<span class="err">┌──────────┐</span>
<span class="err">│</span> <span class="o">?</span><span class="k">column</span><span class="o">?</span> <span class="err">│</span>
<span class="err">├──────────┤</span>
<span class="err">│</span>        <span class="mi">2</span> <span class="err">│</span>
<span class="err">└──────────┘</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>

<span class="p">....</span> <span class="n">v</span><span class="err">á</span><span class="n">rias</span> <span class="n">linhas</span> <span class="n">aqui</span><span class="p">...</span>
<span class="err">┌──────────┐</span>
<span class="err">│</span> <span class="o">?</span><span class="k">column</span><span class="o">?</span> <span class="err">│</span>
<span class="err">├──────────┤</span>
<span class="err">│</span>        <span class="mi">9</span> <span class="err">│</span>
<span class="err">└──────────┘</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>

<span class="err">┌──────────┐</span>
<span class="err">│</span> <span class="o">?</span><span class="k">column</span><span class="o">?</span> <span class="err">│</span>
<span class="err">├──────────┤</span>
<span class="err">│</span>       <span class="mi">10</span> <span class="err">│</span>
<span class="err">└──────────┘</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>

</code></pre></div></div>

<h2 id="output">Output</h2>

<p>Se você quiser salvar os resultados da query em um arquivo ao invés de exibir no
terminal pode usar as seguintes opções:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">\g &lt;arquivo&gt;</code> envia ultima query para um arquivo.</li>
  <li><code class="language-plaintext highlighter-rouge">\o &lt;arquivo&gt;</code> concatena os resultados para um arquivo.</li>
</ol>

<p>Uma dica para quem está gostando de se aprofundar nos comandos é dar uma olhada no site 
https://psql-tips.org que contém uma série de exemplos de como evoluir nos
comandos.</p>

<h2 id="explicar-consultas">Explicar consultas</h2>

<p>Eu gosto muito do <code class="language-plaintext highlighter-rouge">psql -E</code> que ajuda você a entender os comandos com a barra
invertida. Por exemplo <code class="language-plaintext highlighter-rouge">\dt</code> vai listar as tabelas, e com o <code class="language-plaintext highlighter-rouge">-E</code> você pode entender
que query o psql usou para mostrar os resultados.</p>

<p>Exemplo:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="err">\</span><span class="n">dt</span>
<span class="o">*********</span> <span class="n">QUERY</span> <span class="o">**********</span>
<span class="k">SELECT</span> <span class="n">n</span><span class="p">.</span><span class="n">nspname</span> <span class="k">as</span> <span class="nv">"Schema"</span><span class="p">,</span>
  <span class="k">c</span><span class="p">.</span><span class="n">relname</span> <span class="k">as</span> <span class="nv">"Name"</span><span class="p">,</span>
  <span class="k">CASE</span> <span class="k">c</span><span class="p">.</span><span class="n">relkind</span> <span class="k">WHEN</span> <span class="s1">'r'</span> <span class="k">THEN</span> <span class="s1">'table'</span> <span class="k">WHEN</span> <span class="s1">'v'</span> <span class="k">THEN</span> <span class="s1">'view'</span> <span class="k">WHEN</span> <span class="s1">'m'</span> <span class="k">THEN</span> <span class="s1">'materialized view'</span> <span class="k">WHEN</span> <span class="s1">'i'</span> <span class="k">THEN</span> <span class="s1">'index'</span> <span class="k">WHEN</span> <span class="s1">'S'</span> <span class="k">THEN</span> <span class="s1">'sequence'</span> <span class="k">WHEN</span> <span class="s1">'s'</span> <span class="k">THEN</span> <span class="s1">'special'</span> <span class="k">WHEN</span> <span class="s1">'t'</span> <span class="k">THEN</span> <span class="s1">'TOAST table'</span> <span class="k">WHEN</span> <span class="s1">'f'</span> <span class="k">THEN</span> <span class="s1">'foreign table'</span> <span class="k">WHEN</span> <span class="s1">'p'</span> <span class="k">THEN</span> <span class="s1">'partitioned table'</span> <span class="k">WHEN</span> <span class="s1">'I'</span> <span class="k">THEN</span> <span class="s1">'partitioned index'</span> <span class="k">END</span> <span class="k">as</span> <span class="nv">"Type"</span><span class="p">,</span>
  <span class="n">pg_catalog</span><span class="p">.</span><span class="n">pg_get_userbyid</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">relowner</span><span class="p">)</span> <span class="k">as</span> <span class="nv">"Owner"</span>
<span class="k">FROM</span> <span class="n">pg_catalog</span><span class="p">.</span><span class="n">pg_class</span> <span class="k">c</span>
     <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">pg_catalog</span><span class="p">.</span><span class="n">pg_namespace</span> <span class="n">n</span> <span class="k">ON</span> <span class="n">n</span><span class="p">.</span><span class="n">oid</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">relnamespace</span>
     <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">pg_catalog</span><span class="p">.</span><span class="n">pg_am</span> <span class="n">am</span> <span class="k">ON</span> <span class="n">am</span><span class="p">.</span><span class="n">oid</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">relam</span>
<span class="k">WHERE</span> <span class="k">c</span><span class="p">.</span><span class="n">relkind</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'r'</span><span class="p">,</span><span class="s1">'p'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span>
      <span class="k">AND</span> <span class="n">n</span><span class="p">.</span><span class="n">nspname</span> <span class="o">&lt;&gt;</span> <span class="s1">'pg_catalog'</span>
      <span class="k">AND</span> <span class="n">n</span><span class="p">.</span><span class="n">nspname</span> <span class="o">!~</span> <span class="s1">'^pg_toast'</span>
      <span class="k">AND</span> <span class="n">n</span><span class="p">.</span><span class="n">nspname</span> <span class="o">&lt;&gt;</span> <span class="s1">'information_schema'</span>
  <span class="k">AND</span> <span class="n">pg_catalog</span><span class="p">.</span><span class="n">pg_table_is_visible</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">oid</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">;</span>
<span class="o">**************************</span>

                <span class="n">List</span> <span class="k">of</span> <span class="n">relations</span>
<span class="err">┌────────┬──────────────────┬───────┬───────────┐</span>
<span class="err">│</span> <span class="k">Schema</span> <span class="err">│</span>       <span class="n">Name</span>       <span class="err">│</span> <span class="k">Type</span>  <span class="err">│</span>   <span class="k">Owner</span>   <span class="err">│</span>
<span class="err">├────────┼──────────────────┼───────┼───────────┤</span>
<span class="err">│</span> <span class="k">public</span> <span class="err">│</span> <span class="n">example</span>          <span class="err">│</span> <span class="k">table</span> <span class="err">│</span> <span class="n">jonatasdp</span> <span class="err">│</span>
<span class="err">│</span> <span class="k">public</span> <span class="err">│</span> <span class="n">another_table</span>    <span class="err">│</span> <span class="k">table</span> <span class="err">│</span> <span class="n">jonatasdp</span> <span class="err">│</span>
<span class="err">└────────┴──────────────────┴───────┴───────────┘</span>
<span class="p">(</span><span class="mi">2</span> <span class="k">rows</span><span class="p">)</span>
</code></pre></div></div>

<p>Lembrando que o -E vai funcionar apenas para comandos que envolvem queries.</p>

<h2 id="transformando-linhas-em-colunas">Transformando linhas em colunas</h2>

<p>No caso de linhas muito longas, será difícil de visualizar no terminal, então
vale a pena usar o <code class="language-plaintext highlighter-rouge">\x on</code> para trocar o formato do output.</p>

<p>Exemplo o <code class="language-plaintext highlighter-rouge">\x</code>. Observe o output:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">table</span> <span class="n">pings</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>
<span class="err">┌─</span><span class="p">[</span> <span class="n">RECORD</span> <span class="mi">1</span> <span class="p">]</span><span class="err">──────────────────────┐</span>
<span class="err">│</span> <span class="n">t</span>    <span class="err">│</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">05</span> <span class="mi">14</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">21</span><span class="p">.</span><span class="mi">439023</span> <span class="err">│</span>
<span class="err">│</span> <span class="n">ms</span>   <span class="err">│</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0031</span>                     <span class="err">│</span>
<span class="err">│</span> <span class="k">host</span> <span class="err">│</span> <span class="n">google</span><span class="p">.</span><span class="n">com</span>                 <span class="err">│</span>
<span class="err">└──────┴────────────────────────────┘</span>
</code></pre></div></div>

<p>O <code class="language-plaintext highlighter-rouge">\x</code> serve para trocar o modo de visualização de tabelas em linhas ou colunas,
de forma expandida ou não. Se você não usar argumentos o psql alterna o
parâmetro entre <code class="language-plaintext highlighter-rouge">on</code> e <code class="language-plaintext highlighter-rouge">off</code> automaticamente.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">db</span><span class="o">=#</span> <span class="err">\</span><span class="n">x</span>
<span class="n">Expanded</span> <span class="n">display</span> <span class="k">is</span> <span class="k">off</span><span class="p">.</span>
<span class="n">db</span><span class="o">=#</span> <span class="k">table</span> <span class="n">pings</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">;</span>
<span class="err">┌────────────────────────────┬────────┬────────────┐</span>
<span class="err">│</span>             <span class="n">t</span>              <span class="err">│</span>   <span class="n">ms</span>   <span class="err">│</span>    <span class="k">host</span>    <span class="err">│</span>
<span class="err">├────────────────────────────┼────────┼────────────┤</span>
<span class="err">│</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">05</span> <span class="mi">14</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">21</span><span class="p">.</span><span class="mi">439023</span> <span class="err">│</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0031</span> <span class="err">│</span> <span class="n">google</span><span class="p">.</span><span class="n">com</span> <span class="err">│</span>
<span class="err">└────────────────────────────┴────────┴────────────┘</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</code></pre></div></div>

<p>Também é possível usar o <code class="language-plaintext highlighter-rouge">\x auto</code> que irá mudar a visão automaticamente para
mostrar colunas em linhas caso o conteúdo tenha muitas colunas ou valores muito
longos que quebrem o layout da tela.</p>

<h3 id="psql-comandos-com-">psql comandos com <code class="language-plaintext highlighter-rouge">\</code></h3>

<p>O psql tem vários comandos que começam com a barra invertida e eles se tornam
extremamente úteis para não ter que lembrar de todos os comandos. Então é só
lembrar do <code class="language-plaintext highlighter-rouge">?</code> para listar esse help com todos os comandos com barra invertida.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\?
</code></pre></div></div>

<p>Aqui você pode relembrar sempre que precisar de um atalho rápido. Um detalhe
importante quando você ver esse <code class="language-plaintext highlighter-rouge">:</code> na última linha da explicação, isso
significa que o pager está em ação. O more é um utilitário de pager assim como o <code class="language-plaintext highlighter-rouge">less</code>.</p>

<p>Então vamos aprender um pouco sobre estes dois amiguinhos agora.</p>

<p>Esse comando vai listar todos os comandos com uma explicação.</p>

<p>Segue a lista de saída:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">db</span><span class="o">=#</span> <span class="err">\</span><span class="o">?</span>
<span class="k">General</span>
  <span class="err">\</span><span class="n">copyright</span>             <span class="k">show</span> <span class="n">PostgreSQL</span> <span class="k">usage</span> <span class="k">and</span> <span class="n">distribution</span> <span class="n">terms</span>
  <span class="err">\</span><span class="n">crosstabview</span> <span class="p">[</span><span class="n">COLUMNS</span><span class="p">]</span> <span class="k">execute</span> <span class="n">query</span> <span class="k">and</span> <span class="n">display</span> <span class="n">results</span> <span class="k">in</span> <span class="n">crosstab</span>
  <span class="err">\</span><span class="n">errverbose</span>            <span class="k">show</span> <span class="n">most</span> <span class="n">recent</span> <span class="n">error</span> <span class="n">message</span> <span class="k">at</span> <span class="n">maximum</span> <span class="n">verbosity</span>
  <span class="err">\</span><span class="k">g</span> <span class="p">[(</span><span class="k">OPTIONS</span><span class="p">)]</span> <span class="p">[</span><span class="n">FILE</span><span class="p">]</span>  <span class="k">execute</span> <span class="n">query</span> <span class="p">(</span><span class="k">and</span> <span class="n">send</span> <span class="n">results</span> <span class="k">to</span> <span class="n">file</span> <span class="k">or</span> <span class="o">|</span><span class="n">pipe</span><span class="p">);</span>
                         <span class="err">\</span><span class="k">g</span> <span class="k">with</span> <span class="k">no</span> <span class="n">arguments</span> <span class="k">is</span> <span class="n">equivalent</span> <span class="k">to</span> <span class="n">a</span> <span class="n">semicolon</span>
  <span class="err">\</span><span class="n">gdesc</span>                 <span class="k">describe</span> <span class="k">result</span> <span class="k">of</span> <span class="n">query</span><span class="p">,</span> <span class="k">without</span> <span class="n">executing</span> <span class="n">it</span>
  <span class="err">\</span><span class="n">gexec</span>                 <span class="k">execute</span> <span class="n">query</span><span class="p">,</span> <span class="k">then</span> <span class="k">execute</span> <span class="k">each</span> <span class="n">value</span> <span class="k">in</span> <span class="n">its</span> <span class="k">result</span>
  <span class="err">\</span><span class="n">gset</span> <span class="p">[</span><span class="k">PREFIX</span><span class="p">]</span>         <span class="k">execute</span> <span class="n">query</span> <span class="k">and</span> <span class="n">store</span> <span class="n">results</span> <span class="k">in</span> <span class="n">psql</span> <span class="n">variables</span>
  <span class="err">\</span><span class="n">gx</span> <span class="p">[(</span><span class="k">OPTIONS</span><span class="p">)]</span> <span class="p">[</span><span class="n">FILE</span><span class="p">]</span> <span class="k">as</span> <span class="err">\</span><span class="k">g</span><span class="p">,</span> <span class="n">but</span> <span class="n">forces</span> <span class="n">expanded</span> <span class="k">output</span> <span class="k">mode</span>
  <span class="err">\</span><span class="n">q</span>                     <span class="n">quit</span> <span class="n">psql</span>
  <span class="err">\</span><span class="n">watch</span> <span class="p">[</span><span class="n">SEC</span><span class="p">]</span>           <span class="k">execute</span> <span class="n">query</span> <span class="k">every</span> <span class="n">SEC</span> <span class="n">seconds</span>

<span class="n">Help</span>
  <span class="err">\</span><span class="o">?</span> <span class="p">[</span><span class="n">commands</span><span class="p">]</span>          <span class="k">show</span> <span class="n">help</span> <span class="k">on</span> <span class="n">backslash</span> <span class="n">commands</span>
  <span class="err">\</span><span class="o">?</span> <span class="k">options</span>             <span class="k">show</span> <span class="n">help</span> <span class="k">on</span> <span class="n">psql</span> <span class="n">command</span><span class="o">-</span><span class="n">line</span> <span class="k">options</span>
  <span class="err">\</span><span class="o">?</span> <span class="n">variables</span>           <span class="k">show</span> <span class="n">help</span> <span class="k">on</span> <span class="n">special</span> <span class="n">variables</span>
  <span class="err">\</span><span class="n">h</span> <span class="p">[</span><span class="n">NAME</span><span class="p">]</span>              <span class="n">help</span> <span class="k">on</span> <span class="n">syntax</span> <span class="k">of</span> <span class="k">SQL</span> <span class="n">commands</span><span class="p">,</span> <span class="o">*</span> <span class="k">for</span> <span class="k">all</span> <span class="n">commands</span>

<span class="n">Query</span> <span class="n">Buffer</span>
  <span class="err">\</span><span class="n">e</span> <span class="p">[</span><span class="n">FILE</span><span class="p">]</span> <span class="p">[</span><span class="n">LINE</span><span class="p">]</span>       <span class="n">edit</span> <span class="n">the</span> <span class="n">query</span> <span class="n">buffer</span> <span class="p">(</span><span class="k">or</span> <span class="n">file</span><span class="p">)</span> <span class="k">with</span> <span class="k">external</span> <span class="n">editor</span>
  <span class="err">\</span><span class="n">ef</span> <span class="p">[</span><span class="n">FUNCNAME</span> <span class="p">[</span><span class="n">LINE</span><span class="p">]]</span>  <span class="n">edit</span> <span class="k">function</span> <span class="n">definition</span> <span class="k">with</span> <span class="k">external</span> <span class="n">editor</span>
  <span class="err">\</span><span class="n">ev</span> <span class="p">[</span><span class="n">VIEWNAME</span> <span class="p">[</span><span class="n">LINE</span><span class="p">]]</span>  <span class="n">edit</span> <span class="k">view</span> <span class="n">definition</span> <span class="k">with</span> <span class="k">external</span> <span class="n">editor</span>
  <span class="err">\</span><span class="n">p</span>                     <span class="k">show</span> <span class="n">the</span> <span class="n">contents</span> <span class="k">of</span> <span class="n">the</span> <span class="n">query</span> <span class="n">buffer</span>
  <span class="err">\</span><span class="n">r</span>                     <span class="k">reset</span> <span class="p">(</span><span class="n">clear</span><span class="p">)</span> <span class="n">the</span> <span class="n">query</span> <span class="n">buffer</span>
  <span class="err">\</span><span class="n">s</span> <span class="p">[</span><span class="n">FILE</span><span class="p">]</span>              <span class="n">display</span> <span class="n">history</span> <span class="k">or</span> <span class="n">save</span> <span class="n">it</span> <span class="k">to</span> <span class="n">file</span>
  <span class="err">\</span><span class="n">w</span> <span class="n">FILE</span>                <span class="k">write</span> <span class="n">query</span> <span class="n">buffer</span> <span class="k">to</span> <span class="n">file</span>

<span class="k">Input</span><span class="o">/</span><span class="k">Output</span>
  <span class="err">\</span><span class="k">copy</span> <span class="p">...</span>              <span class="n">perform</span> <span class="k">SQL</span> <span class="k">COPY</span> <span class="k">with</span> <span class="k">data</span> <span class="n">stream</span> <span class="k">to</span> <span class="n">the</span> <span class="n">client</span> <span class="k">host</span>
  <span class="err">\</span><span class="n">echo</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span>    <span class="k">write</span> <span class="n">string</span> <span class="k">to</span> <span class="n">standard</span> <span class="k">output</span> <span class="p">(</span><span class="o">-</span><span class="n">n</span> <span class="k">for</span> <span class="k">no</span> <span class="n">newline</span><span class="p">)</span>
  <span class="err">\</span><span class="n">i</span> <span class="n">FILE</span>                <span class="k">execute</span> <span class="n">commands</span> <span class="k">from</span> <span class="n">file</span>
  <span class="err">\</span><span class="n">ir</span> <span class="n">FILE</span>               <span class="k">as</span> <span class="err">\</span><span class="n">i</span><span class="p">,</span> <span class="n">but</span> <span class="k">relative</span> <span class="k">to</span> <span class="k">location</span> <span class="k">of</span> <span class="k">current</span> <span class="n">script</span>
  <span class="err">\</span><span class="n">o</span> <span class="p">[</span><span class="n">FILE</span><span class="p">]</span>              <span class="n">send</span> <span class="k">all</span> <span class="n">query</span> <span class="n">results</span> <span class="k">to</span> <span class="n">file</span> <span class="k">or</span> <span class="o">|</span><span class="n">pipe</span>
  <span class="err">\</span><span class="n">qecho</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span>   <span class="k">write</span> <span class="n">string</span> <span class="k">to</span> <span class="err">\</span><span class="n">o</span> <span class="k">output</span> <span class="n">stream</span> <span class="p">(</span><span class="o">-</span><span class="n">n</span> <span class="k">for</span> <span class="k">no</span> <span class="n">newline</span><span class="p">)</span>
  <span class="err">\</span><span class="n">warn</span> <span class="p">[</span><span class="o">-</span><span class="n">n</span><span class="p">]</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span>    <span class="k">write</span> <span class="n">string</span> <span class="k">to</span> <span class="n">standard</span> <span class="n">error</span> <span class="p">(</span><span class="o">-</span><span class="n">n</span> <span class="k">for</span> <span class="k">no</span> <span class="n">newline</span><span class="p">)</span>

<span class="n">Conditional</span>
  <span class="err">\</span><span class="n">if</span> <span class="n">EXPR</span>               <span class="k">begin</span> <span class="n">conditional</span> <span class="n">block</span>
  <span class="err">\</span><span class="n">elif</span> <span class="n">EXPR</span>             <span class="n">alternative</span> <span class="n">within</span> <span class="k">current</span> <span class="n">conditional</span> <span class="n">block</span>
  <span class="err">\</span><span class="k">else</span>                  <span class="k">final</span> <span class="n">alternative</span> <span class="n">within</span> <span class="k">current</span> <span class="n">conditional</span> <span class="n">block</span>
  <span class="err">\</span><span class="n">endif</span>                 <span class="k">end</span> <span class="n">conditional</span> <span class="n">block</span>

<span class="n">Informational</span>
  <span class="p">(</span><span class="k">options</span><span class="p">:</span> <span class="n">S</span> <span class="o">=</span> <span class="k">show</span> <span class="k">system</span> <span class="n">objects</span><span class="p">,</span> <span class="o">+</span> <span class="o">=</span> <span class="n">additional</span> <span class="n">detail</span><span class="p">)</span>
  <span class="err">\</span><span class="n">d</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span>                 <span class="n">list</span> <span class="n">tables</span><span class="p">,</span> <span class="n">views</span><span class="p">,</span> <span class="k">and</span> <span class="n">sequences</span>
  <span class="err">\</span><span class="n">d</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span>  <span class="n">NAME</span>           <span class="k">describe</span> <span class="k">table</span><span class="p">,</span> <span class="k">view</span><span class="p">,</span> <span class="n">sequence</span><span class="p">,</span> <span class="k">or</span> <span class="k">index</span>
  <span class="err">\</span><span class="n">da</span><span class="p">[</span><span class="n">S</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">aggregates</span>
  <span class="err">\</span><span class="n">dA</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">access</span> <span class="n">methods</span>
  <span class="err">\</span><span class="n">dAc</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">AMPTRN</span> <span class="p">[</span><span class="n">TYPEPTRN</span><span class="p">]]</span>  <span class="n">list</span> <span class="k">operator</span> <span class="n">classes</span>
  <span class="err">\</span><span class="n">dAf</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">AMPTRN</span> <span class="p">[</span><span class="n">TYPEPTRN</span><span class="p">]]</span>  <span class="n">list</span> <span class="k">operator</span> <span class="n">families</span>
  <span class="err">\</span><span class="n">dAo</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">AMPTRN</span> <span class="p">[</span><span class="n">OPFPTRN</span><span class="p">]]</span>   <span class="n">list</span> <span class="n">operators</span> <span class="k">of</span> <span class="k">operator</span> <span class="n">families</span>
  <span class="err">\</span><span class="n">dAp</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">AMPTRN</span> <span class="p">[</span><span class="n">OPFPTRN</span><span class="p">]]</span>   <span class="n">list</span> <span class="n">support</span> <span class="n">functions</span> <span class="k">of</span> <span class="k">operator</span> <span class="n">families</span>
  <span class="err">\</span><span class="n">db</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">tablespaces</span>
  <span class="err">\</span><span class="n">dc</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">conversions</span>
  <span class="err">\</span><span class="n">dC</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">casts</span>
  <span class="err">\</span><span class="n">dd</span><span class="p">[</span><span class="n">S</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="k">show</span> <span class="k">object</span> <span class="n">descriptions</span> <span class="k">not</span> <span class="n">displayed</span> <span class="n">elsewhere</span>
  <span class="err">\</span><span class="n">dD</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">domains</span>
  <span class="err">\</span><span class="n">ddp</span>    <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">default</span> <span class="k">privileges</span>
  <span class="err">\</span><span class="n">dE</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">foreign</span> <span class="n">tables</span>
  <span class="err">\</span><span class="n">des</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">foreign</span> <span class="n">servers</span>
  <span class="err">\</span><span class="n">det</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">foreign</span> <span class="n">tables</span>
  <span class="err">\</span><span class="n">deu</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">user</span> <span class="n">mappings</span>
  <span class="err">\</span><span class="n">dew</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">foreign</span><span class="o">-</span><span class="k">data</span> <span class="n">wrappers</span>
  <span class="err">\</span><span class="n">df</span><span class="p">[</span><span class="n">anptw</span><span class="p">][</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">FUNCPTRN</span> <span class="p">[</span><span class="n">TYPEPTRN</span> <span class="p">...]]</span>
                         <span class="n">list</span> <span class="p">[</span><span class="k">only</span> <span class="n">agg</span><span class="o">/</span><span class="n">normal</span><span class="o">/</span><span class="k">procedure</span><span class="o">/</span><span class="k">trigger</span><span class="o">/</span><span class="k">window</span><span class="p">]</span> <span class="n">functions</span>
  <span class="err">\</span><span class="n">dF</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="nb">text</span> <span class="k">search</span> <span class="n">configurations</span>
  <span class="err">\</span><span class="n">dFd</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="nb">text</span> <span class="k">search</span> <span class="n">dictionaries</span>
  <span class="err">\</span><span class="n">dFp</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="nb">text</span> <span class="k">search</span> <span class="n">parsers</span>
  <span class="err">\</span><span class="n">dFt</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="nb">text</span> <span class="k">search</span> <span class="n">templates</span>
  <span class="err">\</span><span class="n">dg</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">roles</span>
  <span class="err">\</span><span class="n">di</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">indexes</span>
  <span class="err">\</span><span class="n">dl</span>                    <span class="n">list</span> <span class="k">large</span> <span class="n">objects</span><span class="p">,</span> <span class="n">same</span> <span class="k">as</span> <span class="err">\</span><span class="n">lo_list</span>
  <span class="err">\</span><span class="n">dL</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">procedural</span> <span class="n">languages</span>
  <span class="err">\</span><span class="n">dm</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">materialized</span> <span class="n">views</span>
  <span class="err">\</span><span class="n">dn</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">schemas</span>
  <span class="err">\</span><span class="k">do</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">OPPTRN</span> <span class="p">[</span><span class="n">TYPEPTRN</span> <span class="p">[</span><span class="n">TYPEPTRN</span><span class="p">]]]</span>
                         <span class="n">list</span> <span class="n">operators</span>
  <span class="err">\</span><span class="k">dO</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">collations</span>
  <span class="err">\</span><span class="n">dp</span>     <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">table</span><span class="p">,</span> <span class="k">view</span><span class="p">,</span> <span class="k">and</span> <span class="n">sequence</span> <span class="k">access</span> <span class="k">privileges</span>
  <span class="err">\</span><span class="n">dP</span><span class="p">[</span><span class="n">itn</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>    <span class="n">list</span> <span class="p">[</span><span class="k">only</span> <span class="k">index</span><span class="o">/</span><span class="k">table</span><span class="p">]</span> <span class="n">partitioned</span> <span class="n">relations</span> <span class="p">[</span><span class="n">n</span><span class="o">=</span><span class="n">nested</span><span class="p">]</span>
  <span class="err">\</span><span class="n">drds</span> <span class="p">[</span><span class="n">ROLEPTRN</span> <span class="p">[</span><span class="n">DBPTRN</span><span class="p">]]</span> <span class="n">list</span> <span class="n">per</span><span class="o">-</span><span class="k">database</span> <span class="k">role</span> <span class="n">settings</span>
  <span class="err">\</span><span class="n">dRp</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">replication</span> <span class="n">publications</span>
  <span class="err">\</span><span class="n">dRs</span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">replication</span> <span class="n">subscriptions</span>
  <span class="err">\</span><span class="n">ds</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">sequences</span>
  <span class="err">\</span><span class="n">dt</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">tables</span>
  <span class="err">\</span><span class="n">dT</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="k">data</span> <span class="n">types</span>
  <span class="err">\</span><span class="n">du</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">roles</span>
  <span class="err">\</span><span class="n">dv</span><span class="p">[</span><span class="n">S</span><span class="o">+</span><span class="p">]</span> <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">views</span>
  <span class="err">\</span><span class="n">dx</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">extensions</span>
  <span class="err">\</span><span class="n">dX</span>     <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">extended</span> <span class="k">statistics</span>
  <span class="err">\</span><span class="n">dy</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">event</span> <span class="n">triggers</span>
  <span class="err">\</span><span class="n">l</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>   <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">list</span> <span class="n">databases</span>
  <span class="err">\</span><span class="n">sf</span><span class="p">[</span><span class="o">+</span><span class="p">]</span>  <span class="n">FUNCNAME</span>       <span class="k">show</span> <span class="n">a</span> <span class="k">function</span><span class="s1">'s definition
  </span><span class="se">\s</span><span class="s1">v[+]  VIEWNAME       show a view'</span><span class="n">s</span> <span class="n">definition</span>
  <span class="err">\</span><span class="n">z</span>      <span class="p">[</span><span class="n">PATTERN</span><span class="p">]</span>      <span class="n">same</span> <span class="k">as</span> <span class="err">\</span><span class="n">dp</span>

<span class="n">Formatting</span>
  <span class="err">\</span><span class="n">a</span>                     <span class="n">toggle</span> <span class="k">between</span> <span class="n">unaligned</span> <span class="k">and</span> <span class="n">aligned</span> <span class="k">output</span> <span class="k">mode</span>
  <span class="err">\</span><span class="k">C</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span>            <span class="k">set</span> <span class="k">table</span> <span class="n">title</span><span class="p">,</span> <span class="k">or</span> <span class="n">unset</span> <span class="n">if</span> <span class="k">none</span>
  <span class="err">\</span><span class="n">f</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span>            <span class="k">show</span> <span class="k">or</span> <span class="k">set</span> <span class="n">field</span> <span class="n">separator</span> <span class="k">for</span> <span class="n">unaligned</span> <span class="n">query</span> <span class="k">output</span>
  <span class="err">\</span><span class="n">H</span>                     <span class="n">toggle</span> <span class="n">HTML</span> <span class="k">output</span> <span class="k">mode</span> <span class="p">(</span><span class="n">currently</span> <span class="k">off</span><span class="p">)</span>
  <span class="err">\</span><span class="n">pset</span> <span class="p">[</span><span class="n">NAME</span> <span class="p">[</span><span class="n">VALUE</span><span class="p">]]</span>   <span class="k">set</span> <span class="k">table</span> <span class="k">output</span> <span class="k">option</span>
                         <span class="p">(</span><span class="n">border</span><span class="o">|</span><span class="n">columns</span><span class="o">|</span><span class="n">csv_fieldsep</span><span class="o">|</span><span class="n">expanded</span><span class="o">|</span><span class="n">fieldsep</span><span class="o">|</span>
                         <span class="n">fieldsep_zero</span><span class="o">|</span><span class="n">footer</span><span class="o">|</span><span class="n">format</span><span class="o">|</span><span class="n">linestyle</span><span class="o">|</span><span class="k">null</span><span class="o">|</span>
                         <span class="n">numericlocale</span><span class="o">|</span><span class="n">pager</span><span class="o">|</span><span class="n">pager_min_lines</span><span class="o">|</span><span class="n">recordsep</span><span class="o">|</span>
                         <span class="n">recordsep_zero</span><span class="o">|</span><span class="n">tableattr</span><span class="o">|</span><span class="n">title</span><span class="o">|</span><span class="n">tuples_only</span><span class="o">|</span>
                         <span class="n">unicode_border_linestyle</span><span class="o">|</span><span class="n">unicode_column_linestyle</span><span class="o">|</span>
                         <span class="n">unicode_header_linestyle</span><span class="p">)</span>
  <span class="err">\</span><span class="n">t</span> <span class="p">[</span><span class="k">on</span><span class="o">|</span><span class="k">off</span><span class="p">]</span>            <span class="k">show</span> <span class="k">only</span> <span class="k">rows</span> <span class="p">(</span><span class="n">currently</span> <span class="k">off</span><span class="p">)</span>
  <span class="err">\</span><span class="n">T</span> <span class="p">[</span><span class="n">STRING</span><span class="p">]</span>            <span class="k">set</span> <span class="n">HTML</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="n">tag</span> <span class="n">attributes</span><span class="p">,</span> <span class="k">or</span> <span class="n">unset</span> <span class="n">if</span> <span class="k">none</span>
  <span class="err">\</span><span class="n">x</span> <span class="p">[</span><span class="k">on</span><span class="o">|</span><span class="k">off</span><span class="o">|</span><span class="n">auto</span><span class="p">]</span>       <span class="n">toggle</span> <span class="n">expanded</span> <span class="k">output</span> <span class="p">(</span><span class="n">currently</span> <span class="n">auto</span><span class="p">)</span>

<span class="k">Connection</span>
  <span class="err">\</span><span class="k">c</span><span class="p">[</span><span class="n">onnect</span><span class="p">]</span> <span class="p">{[</span><span class="n">DBNAME</span><span class="o">|-</span> <span class="k">USER</span><span class="o">|-</span> <span class="k">HOST</span><span class="o">|-</span> <span class="n">PORT</span><span class="o">|-</span><span class="p">]</span> <span class="o">|</span> <span class="n">conninfo</span><span class="p">}</span>
                         <span class="k">connect</span> <span class="k">to</span> <span class="k">new</span> <span class="k">database</span> <span class="p">(</span><span class="n">currently</span> <span class="nv">"playground"</span><span class="p">)</span>
  <span class="err">\</span><span class="n">conninfo</span>              <span class="n">display</span> <span class="n">information</span> <span class="n">about</span> <span class="k">current</span> <span class="k">connection</span>
  <span class="err">\</span><span class="k">encoding</span> <span class="p">[</span><span class="k">ENCODING</span><span class="p">]</span>   <span class="k">show</span> <span class="k">or</span> <span class="k">set</span> <span class="n">client</span> <span class="k">encoding</span>
  <span class="err">\</span><span class="n">password</span> <span class="p">[</span><span class="n">USERNAME</span><span class="p">]</span>   <span class="n">securely</span> <span class="n">change</span> <span class="n">the</span> <span class="n">password</span> <span class="k">for</span> <span class="n">a</span> <span class="k">user</span>

<span class="n">Operating</span> <span class="k">System</span>
  <span class="err">\</span><span class="n">cd</span> <span class="p">[</span><span class="n">DIR</span><span class="p">]</span>              <span class="n">change</span> <span class="n">the</span> <span class="k">current</span> <span class="n">working</span> <span class="n">directory</span>
  <span class="err">\</span><span class="n">setenv</span> <span class="n">NAME</span> <span class="p">[</span><span class="n">VALUE</span><span class="p">]</span>   <span class="k">set</span> <span class="k">or</span> <span class="n">unset</span> <span class="n">environment</span> <span class="k">variable</span>
  <span class="err">\</span><span class="n">timing</span> <span class="p">[</span><span class="k">on</span><span class="o">|</span><span class="k">off</span><span class="p">]</span>       <span class="n">toggle</span> <span class="n">timing</span> <span class="k">of</span> <span class="n">commands</span> <span class="p">(</span><span class="n">currently</span> <span class="k">off</span><span class="p">)</span>
  <span class="err">\</span><span class="o">!</span> <span class="p">[</span><span class="n">COMMAND</span><span class="p">]</span>           <span class="k">execute</span> <span class="n">command</span> <span class="k">in</span> <span class="n">shell</span> <span class="k">or</span> <span class="k">start</span> <span class="n">interactive</span> <span class="n">shell</span>

<span class="n">Variables</span>
  <span class="err">\</span><span class="n">prompt</span> <span class="p">[</span><span class="nb">TEXT</span><span class="p">]</span> <span class="n">NAME</span>    <span class="n">prompt</span> <span class="k">user</span> <span class="k">to</span> <span class="k">set</span> <span class="n">internal</span> <span class="k">variable</span>
  <span class="err">\</span><span class="k">set</span> <span class="p">[</span><span class="n">NAME</span> <span class="p">[</span><span class="n">VALUE</span><span class="p">]]</span>    <span class="k">set</span> <span class="n">internal</span> <span class="k">variable</span><span class="p">,</span> <span class="k">or</span> <span class="n">list</span> <span class="k">all</span> <span class="n">if</span> <span class="k">no</span> <span class="k">parameters</span>
  <span class="err">\</span><span class="n">unset</span> <span class="n">NAME</span>            <span class="n">unset</span> <span class="p">(</span><span class="k">delete</span><span class="p">)</span> <span class="n">internal</span> <span class="k">variable</span>

<span class="k">Large</span> <span class="n">Objects</span>
  <span class="err">\</span><span class="n">lo_export</span> <span class="n">LOBOID</span> <span class="n">FILE</span>
  <span class="err">\</span><span class="n">lo_import</span> <span class="n">FILE</span> <span class="p">[</span><span class="k">COMMENT</span><span class="p">]</span>
  <span class="err">\</span><span class="n">lo_list</span>
  <span class="err">\</span><span class="n">lo_unlink</span> <span class="n">LOBOID</span>      <span class="k">large</span> <span class="k">object</span> <span class="n">operations</span>
</code></pre></div></div>

<p>São muitas opções mesmo! apenas comandos internos do psql e são super úteis para
navegar em qualquer detalhe do banco de dados sem ter que abrir o pgadmin 🤐</p>

<h2 id="configurações">Configurações</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">\</span><span class="n">pset</span> <span class="n">numericlocale</span> <span class="o">#</span> <span class="n">Locale</span><span class="o">-</span><span class="n">adjusted</span> <span class="nb">numeric</span> <span class="k">output</span> <span class="k">is</span> <span class="k">on</span><span class="p">.</span>
<span class="err">\</span><span class="k">set</span> <span class="n">io_timing_track</span> <span class="o">#</span> <span class="n">useful</span> <span class="k">to</span> <span class="k">explain</span> <span class="n">queries</span>
</code></pre></div></div>

<h2 id="print-set-com-pset">Print set com <code class="language-plaintext highlighter-rouge">\pset</code></h2>

<p>O pset ou printset é muito parecido com o <code class="language-plaintext highlighter-rouge">\set</code> que funciona para qualquer
cliente do postgresql mas é focado em print. Ou seja, ele vai te ajudar a
formatar a saída de dados do formato que você espera.</p>

<p>Um exemplo da comunidade que adorei e nunca tinha usado é o override para
valores nulos.
Por exemplo, se você usar:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">null</span><span class="p">;</span>
<span class="o">?</span><span class="k">column</span><span class="o">?</span>
</code></pre></div></div>

<p>então fica difícil de entender que a linha em branco quer dizer nulo:</p>

<p>Aí você pode reconfigurar o null para exibir algo de sua preferência:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>\pset null '&lt;nulo&gt;'
Null display is "&lt;nulo&gt;".
db=# select null;
?column?
&lt;nulo&gt;
</code></pre></div></div>

<p>Lembrando que é unicode também, e você pode ter os seus próprios emojis
pra tornar tudo mais divertido:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="err">\</span><span class="n">pset</span> <span class="k">null</span> <span class="s1">'🙈'</span>
<span class="k">Null</span> <span class="n">display</span> <span class="k">is</span> <span class="nv">"🙈"</span><span class="p">.</span>
</code></pre></div></div>

<p>Adoro esse macaquinho, bora testar ;)</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="k">null</span><span class="p">;</span>
<span class="o">?</span><span class="k">column</span><span class="o">?</span>
<span class="err">🙈</span>
</code></pre></div></div>

<h2 id="watch-para-assistir-queries"><code class="language-plaintext highlighter-rouge">\watch</code> para assistir queries</h2>

<p>O comando <code class="language-plaintext highlighter-rouge">\watch</code> é  incrível pra evitar você ficar repetindo o mesmo comando e
permite vc criar um mini-dashboard, literalmente assistindo uma determinada
query.</p>

<p>Então se você executou uma query como:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">tabela</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="k">desc</span> <span class="k">limit</span> <span class="mi">10</span><span class="p">;</span>
</code></pre></div></div>

<p>Este comando irá mostrar os últimos dez registros da tabela.</p>

<p>Muitas vezes você quer ficar assistindo o comando e vendo novos registros, então
fica freneticamente acessando o histórico e reexecutando a consulta.</p>

<p>Você pode usar o <code class="language-plaintext highlighter-rouge">\gexec</code> para fazer o mesmo e evitar redigitar a query ou
acessar o histórico.</p>

<h2 id="aprenda-mais">Aprenda mais</h2>

<p>O site <a href="https://psql-tips.org">psql-tips.org</a> é muito bom para aprender mais
sobre psql. A Lætitia Avrot tem uma palestra muito boa chamada
<a href="https://www.youtube.com/watch?v=2oFbnJDlwIw"><code class="language-plaintext highlighter-rouge">psql</code> is awesome!</a> com várias
dicas práticas para aprender mais.
Se você estiver com dúvidas como instalar o psql, pode ver esse tutorial da
timescale <a href="https://docs.timescale.com/timescaledb/latest/how-to-guides/connecting/psql/#install-psql-on-macos">how to install psql</a>
que contém detalhes sobre como instalar nos principais sistemas operacionais.</p>

<p>Gostou do conteúdo, faltou algum comando essencial?
Me chama no <a href="https://twitter.com/jonatasdp">twitter</a> ou <a href="https://br.linkedin.com/in/jonatasdp">linkedin</a>.</p>

<p>O conteúdo da minha palestra também foi publicado no github. Você pode ver no
repositório <a href="https://github.com/jonatas/pgconfbr2022-talk">pgconfbr2022-talk</a>.</p>

  </div>
  
  
  <div class="article-tags">
    
      <a href="#terminal-ref" class="article-tag">terminal</a>
    
      <a href="#shell-ref" class="article-tag">shell</a>
    
      <a href="#unix-ref" class="article-tag">unix</a>
    
      <a href="#opensource-ref" class="article-tag">opensource</a>
    
      <a href="#postgresql-ref" class="article-tag">postgresql</a>
    
      <a href="#talk-ref" class="article-tag">talk</a>
    
  </div>
  
  
  
<div class="social-sharing mb-4">
  <h5>Share this article</h5>
  <div class="sharing-buttons">
    
    <a href="https://twitter.com/intent/tweet?text=PGConf+Brasil&url=https%3A%2F%2Fideia.me%2Fpgconfbr-talk&via=jonatasdp" 
       class="btn btn-twitter btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-twitter"></i> Twitter
    </a>
    
    
    
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fideia.me%2Fpgconfbr-talk" 
       class="btn btn-facebook btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-facebook"></i> Facebook
    </a>
    
    
    
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fideia.me%2Fpgconfbr-talk&title=PGConf+Brasil" 
       class="btn btn-linkedin btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-linkedin"></i> LinkedIn
    </a>
    
    
    
    <a href="https://reddit.com/submit?url=https%3A%2F%2Fideia.me%2Fpgconfbr-talk&title=PGConf+Brasil" 
       class="btn btn-reddit btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-reddit"></i> Reddit
    </a>
    
  </div>
</div>
 
  <div class="author-bio">
  <img src="/images/jonatas-davi-paganini-profile-2025.png" alt="Jônatas Davi Paganini">
  <div class="author-bio-content">
    <h4>Jônatas Davi Paganini</h4>
    <p>Developer and writer passionate about PostgreSQL, TimescaleDB, and building better systems. Currently sharing knowledge about time series databases and system architecture.</p>
    <div class="author-social">
      <a href="https://github.com/jonatas" target="_blank" title="GitHub"><i class="bi bi-github"></i></a>
      <a href="https://twitter.com/jonatasdp" target="_blank" title="Twitter"><i class="bi bi-twitter"></i></a>
      <a href="https://linkedin.com/in/jonatasdp" target="_blank" title="LinkedIn"><i class="bi bi-linkedin"></i></a>
      
      <a href="https://instagram.com/jonatasdp" target="_blank" title="Instagram"><i class="bi bi-instagram"></i></a>
      
    </div>
  </div>
</div> 
  <div class="content-nav">
  <div class="content-nav-previous">
    
      <small>Previous</small>
      <a href="/time-series-benchmark-timescaledb-raspberry-pi" title="Time Series Benchmark Timescaledb Raspberry Pi">
        Time Series Benchmark Timescaledb Raspberry Pi
      </a>
    
  </div>
  
  <div class="content-nav-next">
    
      <small>Next</small>
      <a href="/writing-plans" title="Writing plans">
        Writing plans
      </a>
    
  </div>
</div> 
  
<div class="related-posts">
  <div class="card">
    <div class="card-header">
      <h4>Related Articles</h4>
    </div>
    <div class="card-body">
      <div class="row">
        
        
        
        
        
          
            
              
              
                
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
                  
                  
              
              
            
          
          
          
        
          
            
              
              
                
                  
                  
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
                  
                  
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
                  
                  
              
              
            
          
          
          
            
        
        
        
        
        
          
            
            
              
            
              
            
              
            
              
                <div class="col-md-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h5 class="card-title">
                        <a href="/my-first-contribution-to-rubygems">My First Contribution To Rubygems</a>
                      </h5>
                      <p class="card-text text-muted">
                        <small>
                          <i class="bi bi-calendar3"></i> July 04, 2024
                        </small>
                      </p>
                      
                        <p class="card-text">Adding to my goal of being helpful in the software world, I had my first contribution to RubyGems [merged][new_pr] 🎉</p>
                      
                    </div>
                  </div>
                </div>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
          
          
        
          
            
            
              
            
              
            
              
            
              
            
              
                <div class="col-md-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h5 class="card-title">
                        <a href="/grepping-sql-code-like-a-boss">Grepping SQL Code like a boss</a>
                      </h5>
                      <p class="card-text text-muted">
                        <small>
                          <i class="bi bi-calendar3"></i> May 27, 2024
                        </small>
                      </p>
                      
                        <p class="card-text">Here's the outline of the content of my talk in Poland I presented at the Lambda Days 2024.</p>
                      
                    </div>
                  </div>
                </div>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
          
          
        
          
            
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <div class="col-md-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h5 class="card-title">
                        <a href="/retrospective-2023">Retrospective 2023</a>
                      </h5>
                      <p class="card-text text-muted">
                        <small>
                          <i class="bi bi-calendar3"></i> December 20, 2023
                        </small>
                      </p>
                      
                        <p class="card-text">I tried to have a restrospective moment every year and it always happen in the last few days of December.</p>
                      
                    </div>
                  </div>
                </div>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
          
          
        
          
            
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                <div class="col-md-6 mb-3">
                  <div class="card h-100">
                    <div class="card-body">
                      <h5 class="card-title">
                        <a href="/sirva-sua-comunidade">Sirva sua comunidade</a>
                      </h5>
                      <p class="card-text text-muted">
                        <small>
                          <i class="bi bi-calendar3"></i> March 30, 2023
                        </small>
                      </p>
                      
                        <p class="card-text">Nos últimos anos, me sinto muito "sortudo" com todas as aprovações que recebi para falar em conferências e participar...</p>
                      
                    </div>
                  </div>
                </div>
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          
          
          
        
        
        
      </div>
    </div>
  </div>
</div>
 
  
<div id="disqus_thread" class="comments-section"></div>
<script>
  var disqus_config = function () {
    this.page.url = '/pgconfbr-talk';
    this.page.identifier = '/pgconfbr-talk';
    
    // Handle dark mode for Disqus
    const isDarkMode = document.documentElement.classList.contains('dark-mode') || 
                        document.body.classList.contains('dark-mode') || 
                        window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    if (isDarkMode) {
      // Enable dark mode for Disqus
      this.page.functions = [];
      this.callbacks = {
        onReady: [function() {
          // Message the iframe to apply dark theme once loaded
          const message = {
            name: 'theme',
            data: {
              theme: 'dark'
            }
          };
          
          // Try to send the message multiple times as Disqus can load slowly
          setTimeout(function() {
            const iframe = document.querySelector('iframe[title="Disqus"]');
            if (iframe && iframe.contentWindow) {
              iframe.contentWindow.postMessage(message, '*');
            }
          }, 2000);
          
          setTimeout(function() {
            const iframe = document.querySelector('iframe[title="Disqus"]');
            if (iframe && iframe.contentWindow) {
              iframe.contentWindow.postMessage(message, '*');
            }
          }, 4000);
        }]
      };
    }
  };

  (function() {
    var d = document, s = d.createElement('script');
    s.src = 'https://ideiame.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    
    // Add dark styling for container
    if (document.documentElement.classList.contains('dark-mode') || 
        document.body.classList.contains('dark-mode') || 
        window.matchMedia('(prefers-color-scheme: dark)').matches) {
      // Style the container immediately
      const style = document.createElement('style');
      style.textContent = `
        #disqus_thread {
          background-color: #1e1e1e !important;
          color: #f0f2f5 !important;
          padding: 20px;
          border-radius: 8px;
          border: 1px solid rgba(255, 255, 255, 0.1) !important;
          margin-top: 30px;
          margin-bottom: 30px;
        }
        
        iframe {
          background-color: #1e1e1e !important;
          color-scheme: dark !important;
        }
        
        /* Force the iframe document to use dark mode */
        iframe[src*="disqus.com"] {
          color-scheme: dark !important;
          filter: invert(90%) hue-rotate(180deg) !important;
        }
      `;
      document.head.appendChild(style);
    }
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
 
</div>

<link rel="stylesheet" href="/css/enhanced.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
<link rel="stylesheet" href="/css/disable-line-numbers.css">
<script src="/js/disable-line-numbers.js"></script>


    </div>
    
    <footer class="footer bg-light py-4 mt-5">
      <div class="container text-center">
        <p class="text-muted mb-0">© 2025 Jônatas Davi Paganini. All rights reserved.</p>
      </div>
    </footer>

    <!-- Additional scripts for code highlighting and dark mode toggle -->
    <script>
      // Toggle dark mode manually with smoother transition
      document.addEventListener('DOMContentLoaded', function() {
        const darkModeToggle = document.getElementById('darkModeToggle');
        if (darkModeToggle) {
          darkModeToggle.addEventListener('change', function() {
            if (this.checked) {
              document.documentElement.classList.add('dark-mode');
              document.body.classList.add('dark-mode');
              localStorage.setItem('theme', 'dark');
              console.log('Dark mode enabled via toggle');
              
              // Update Disqus theme if it exists
              if (window.DISQUS) {
                try {
                  DISQUS.reset({
                    reload: true,
                    config: function () {
                      this.page.identifier = window.disqus_identifier;
                      this.page.url = window.disqus_url;
                      this.page.title = window.disqus_title;
                      this.forum = window.disqus_shortname;
                    }
                  });
                } catch (e) {
                  console.log('Error resetting Disqus:', e);
                }
              }
            } else {
              document.documentElement.classList.remove('dark-mode');
              document.body.classList.remove('dark-mode');
              localStorage.setItem('theme', 'light');
              console.log('Light mode enabled via toggle');
              
              // Update Disqus theme if it exists
              if (window.DISQUS) {
                try {
                  DISQUS.reset({
                    reload: true,
                    config: function () {
                      this.page.identifier = window.disqus_identifier;
                      this.page.url = window.disqus_url;
                      this.page.title = window.disqus_title;
                      this.forum = window.disqus_shortname;
                    }
                  });
                } catch (e) {
                  console.log('Error resetting Disqus:', e);
                }
              }
            }
            
            // Force reload the page to ensure all styles are applied correctly
            setTimeout(() => {
              window.location.reload();
            }, 100);
          });
        }
        
        // Apply highlighting to code blocks after content loads
        enhanceCodeBlocks();
        if (window.Prism) {
          setTimeout(function() {
            Prism.highlightAll();
          }, 100);
        }
        
        // Configure Disqus for dark mode if needed
        const isDarkMode = document.documentElement.classList.contains('dark-mode');
        if (isDarkMode) {
          // Insert dark mode CSS for Disqus
          const style = document.createElement('style');
          style.innerHTML = `
            #disqus_thread {
              background-color: #1e1e1e !important;
              color: #f0f2f5 !important;
              padding: 20px;
              border-radius: 8px;
              border: 1px solid rgba(255, 255, 255, 0.1);
            }
          `;
          document.head.appendChild(style);
          
          // Set Disqus config variable for dark mode
          window.disqus_config = function() {
            this.page.identifier = window.location.pathname;
            this.page.url = window.location.href;
            this.language = 'en';
            this.sso = {
              name: 'SiteName',
            };
            this.callbacks.onReady = [function() {
              const interval = setInterval(function() {
                if (document.getElementById('dsq-app2')) {
                  clearInterval(interval);
                  const disqusIframe = document.getElementById('dsq-app2');
                  disqusIframe.contentWindow.postMessage({
                    name: 'setTheme',
                    data: 'dark',
                  }, '*');
                }
              }, 100);
            }];
          };
        }
      });
      
      // Reapply highlighting after any AJAX content loads
      document.addEventListener('ajaxComplete', function() {
        enhanceCodeBlocks();
        if (window.Prism) {
          setTimeout(function() {
            Prism.highlightAll();
          }, 100);
        }
      });
    </script>

    <!-- SEO and content improvement scripts -->
    <script src="/assets/js/seo-helper.js"></script>
    <script src="/assets/js/category-standardizer.js"></script>
    <script src="/assets/js/link-validator.js"></script>

    <!-- Add this at the end of the body, just before closing body tag -->
    <script>
      // Scroll animation for fade-in elements - modified to be more selective
      document.addEventListener('DOMContentLoaded', function() {
        const fadeElements = document.querySelectorAll('.fade-in');
        
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
            }
          });
        }, {
          threshold: 0.1
        });
        
        fadeElements.forEach(element => {
          observer.observe(element);
        });
        
        // Only apply fade-in to non-critical UI elements
        // Avoid applying to main content or navigation elements
        const animateElements = document.querySelectorAll('.card:not(.latest-post-card):not(.post-content), .featured-content .card, .post-list-group .list-group-item');
        animateElements.forEach((element, index) => {
          // Add minimal delay to reduce blinking effect
          element.classList.add('fade-in');
          element.style.transitionDelay = `${index * 0.02}s`; // Reduced delay
        });
        
        // Copy code button functionality
        const codeBlocks = document.querySelectorAll('pre');
        codeBlocks.forEach((block) => {
          if (!block.querySelector('.copy-button')) {
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copy';
            
            button.addEventListener('click', () => {
              const code = block.querySelector('code').textContent;
              navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                  button.textContent = 'Copy';
                  button.classList.remove('copied');
                }, 2000);
              });
            });
            
            block.appendChild(button);
          }
        });
      });
    </script>

    <!-- Ensure smooth page transitions -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Add fade-in class to the main content container
        const contentContainer = document.querySelector('.content-container');
        if (contentContainer) {
          // Set initial opacity
          contentContainer.style.opacity = '0';
          
          // Fade in the content
          setTimeout(() => {
            contentContainer.style.transition = 'opacity 0.3s ease';
            contentContainer.style.opacity = '1';
          }, 50);
        }
        
        // Handle page navigation with smooth transitions
        document.querySelectorAll('a').forEach(link => {
          // Only apply to internal links
          if (link.hostname === window.location.hostname && !link.hasAttribute('target')) {
            link.addEventListener('click', function(e) {
              // Don't apply to download links or anchor links
              if (link.hasAttribute('download') || link.getAttribute('href').startsWith('#')) {
                return;
              }
              
              e.preventDefault();
              const destination = link.href;
              
              // Fade out
              if (contentContainer) {
                contentContainer.style.opacity = '0';
              }
              
              // Navigate after a short delay
              setTimeout(() => {
                window.location.href = destination;
              }, 300);
            });
          }
        });
      });
    </script>
    <!-- Profile image swap functionality -->
    <script src="/js/profile-image-swap.js"></script>
    
    <!-- Disqus Dark Mode Handler -->
    <script>
      // Function to handle Disqus dark mode
      function setupDisqusDarkMode() {
        const isDarkMode = document.documentElement.classList.contains('dark-mode');
        
        // Add a style element to target the Disqus iframe
        const disqusStyle = document.createElement('style');
        disqusStyle.innerHTML = `
          html.dark-mode iframe, body.dark-mode iframe {
            color-scheme: dark !important;
          }
          
          html.dark-mode #disqus_thread, body.dark-mode #disqus_thread {
            background-color: #1e1e1e !important;
            color: #f0f2f5 !important;
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
          }
        `;
        document.head.appendChild(disqusStyle);
        
        // Check for Disqus iframe and inject dark styles if needed
        const checkForDisqus = setInterval(() => {
          const disqusThread = document.getElementById('disqus_thread');
          const disqusIframes = document.querySelectorAll('iframe[src*="disqus.com"]');
          
          if (disqusThread || disqusIframes.length > 0) {
            clearInterval(checkForDisqus);
            
            if (isDarkMode) {
              // Try to signal Disqus to use dark theme
              if (window.DISQUS) {
                try {
                  window.DISQUS.host._loadEmbed({
                    color: 'dark',
                  });
                } catch (e) {
                  console.log('Could not set Disqus theme via API');
                }
              }
              
              // Direct CSS approach to all iframes
              disqusIframes.forEach(iframe => {
                try {
                  // Try to access the iframe document
                  const iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
                  
                  // Add dark mode classes and styles
                  if (iframeDocument.body) {
                    iframeDocument.body.classList.add('dark-mode');
                    
                    const darkStyle = iframeDocument.createElement('style');
                    darkStyle.textContent = `
                      body { background-color: #1e1e1e !important; color: #f0f2f5 !important; }
                      .textarea-wrapper, .post-actions, .alert { background-color: #2a2d31 !important; }
                      .wysiwyg__placeholder, input, textarea { color: #f0f2f5 !important; }
                      .publisher-background-color { background-color: #1e1e1e !important; }
                      .publisher-border-color { border-color: rgba(255, 255, 255, 0.1) !important; }
                      .publisher-anchor-color, a { color: #5c9eff !important; }
                    `;
                    iframeDocument.head.appendChild(darkStyle);
                  }
                } catch (e) {
                  console.log('Could not modify Disqus iframe due to CORS policy');
                  
                  // Add a fallback with filter approach
                  if (isDarkMode) {
                    // Apply a CSS filter to invert the colors
                    iframe.style.filter = 'invert(92%) hue-rotate(180deg)';
                  }
                }
              });
            }
          }
        }, 500);
      }
      
      // Run setup when DOM is loaded and after any content changes
      document.addEventListener('DOMContentLoaded', setupDisqusDarkMode);
      document.addEventListener('ajaxComplete', setupDisqusDarkMode);
      
      // Also run after a delay in case Disqus loads later
      setTimeout(setupDisqusDarkMode, 2000);
      setTimeout(setupDisqusDarkMode, 5000);
    </script>
    
    <!-- Dedicated Disqus dark mode handler -->
    <script src="/js/disqus-dark.js"></script>

    <!-- Dark Mode Script -->
    <script>
      function detectColorScheme() {
        // Check saved preference first
        const savedTheme = localStorage.getItem('theme');
        const prefersDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const darkModeToggle = document.getElementById('darkModeToggle');
        
        // Apply theme based on saved preference or system preference
        if (savedTheme === 'dark' || (savedTheme === null && prefersDarkMode)) {
          document.body.classList.add('dark-mode');
          document.documentElement.classList.add('dark-mode');
          if (darkModeToggle) darkModeToggle.checked = true;
          console.log('Dark mode applied on initial load');
        } else {
          document.body.classList.remove('dark-mode');
          document.documentElement.classList.remove('dark-mode');
          if (darkModeToggle) darkModeToggle.checked = false;
          console.log('Light mode applied on initial load');
        }
        
        // Listen for changes in the OS color scheme only if no saved preference
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
          // Only apply system preference if user hasn't manually chosen a theme
          if (localStorage.getItem('theme') === null) {
            const newColorScheme = e.matches ? 'dark' : 'light';
            if (newColorScheme === 'dark') {
              document.body.classList.add('dark-mode');
              document.documentElement.classList.add('dark-mode');
              if (darkModeToggle) darkModeToggle.checked = true;
              console.log('Dark mode applied from system preference change');
            } else {
              document.body.classList.remove('dark-mode');
              document.documentElement.classList.remove('dark-mode');
              if (darkModeToggle) darkModeToggle.checked = false;
              console.log('Light mode applied from system preference change');
            }
          }
        });
      }

      // Initialize dark mode immediately before DOM content is fully loaded
      detectColorScheme();
      
      // Initialize when DOM is loaded
      document.addEventListener('DOMContentLoaded', function() {
        detectColorScheme();
      });
    </script>
  </body>
</html>

