
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
<link rel="stylesheet"
    type="text/css"
    href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js"
    data-cfasync="false"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NV80WM9HT0"></script>
<script>
    // Reads the value of a cookie by name or returns empty string
    function getCookie(name) {
        var b = document.cookie.match('(^|[^;]+)\\s*' + name + '\\s*=\\s*([^;]+)');
        return b ? b.pop() : '';
    }

    // Actually starting analytics up
    function addAnalytics() {
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());
        gtag('config', 'G-NV80WM9HT0');
    }

    // Waiting for the load event
    window.addEventListener("load", function () {
        // Reading "cookieconsent_status" cookie
        const cookieConsent = getCookie('cookieconsent_status');

        // Start analytics if user consented or did not deny
        if (cookieConsent === 'allow' || cookieConsent === '') {
            addAnalytics();
        }

        // Initialise cookie consent banner
        window.cookieconsent.initialise({
            "palette": {
                "popup": {
                    "background": "#efefef",
                    "text": "#404040"
                },
                "button": {
                    "background": "#8ec760",
                    "text": "#ffffff"
                }
            },
            "type": "opt-out",
            "content": {
                "allow": "Approve",
                "dismiss": "Approve",
                "deny": "Reject"
            },
            // Reload the page on user choice to make sure cookie is set
            onStatusChange: function (status, chosenBefore) {
                location.reload();
            }
        })
    });
</script>

    <script async
src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1171230226237014"
crossorigin="anonymous"></script>

    <meta charset="utf-8">
    <title>Anonymize your SQL statements</title>
    <meta name="description" content="As a community manager at Timescale, I frequently engage with our vibrant community, helping members tackle a variety of SQL-related challenges. One common c...">
    <meta name="author" content="Jônatas Davi Paganini">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Modern stylesheet links -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&family=Poppins:wght@400;500;600&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">
    <link href="/css/nimbus-pygments.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">
    <link href="/css/code-highlighting.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <!-- Style overrides for Prism -->
    <style>
      /* Override Prism default styles to fix text shadow issues */
      code[class*="language-"],
      pre[class*="language-"],
      pre code,
      .token {
        text-shadow: none !important;
        -webkit-text-shadow: none !important;
        border: none !important;
        background: none;
      }
      
      /* Ensure proper background only on container elements */
      pre[class*="language-"] {
        background: var(--prism-background);
      }
      
      .dark-mode pre[class*="language-"] {
        background: var(--prism-background);
      }
    </style>

    <!-- Modern JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-ruby.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-sql.min.js"></script>
    <div id="fb-root"></div>

    <!-- Dark Mode Script -->
    <script>
      function detectColorScheme() {
        const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const darkModeToggle = document.getElementById('darkModeToggle');
        
        if (isDarkMode) {
          document.body.classList.add('dark-mode');
          if (darkModeToggle) darkModeToggle.checked = true;
        }
        
        // Listen for changes in the OS color scheme
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
          const newColorScheme = e.matches ? 'dark' : 'light';
          if (newColorScheme === 'dark') {
            document.body.classList.add('dark-mode');
            if (darkModeToggle) darkModeToggle.checked = true;
          } else {
            document.body.classList.remove('dark-mode');
            if (darkModeToggle) darkModeToggle.checked = false;
          }
        });
      }

      // Add code block enhancements
      function enhanceCodeBlocks() {
        document.querySelectorAll('pre code').forEach((codeBlock, index) => {
          // Get the parent pre element
          const preElement = codeBlock.parentElement;
          if (!preElement.classList.contains('enhanced')) {
            preElement.classList.add('enhanced');
            
            // Create a wrapper div with the highlight class
            const highlightDiv = document.createElement('div');
            highlightDiv.className = 'highlight';
            
            // Insert the wrapper before the pre element
            preElement.parentNode.insertBefore(highlightDiv, preElement);
            
            // Move the pre element inside the wrapper
            highlightDiv.appendChild(preElement);
            
            // Get language class from code element
            let language = '';
            codeBlock.classList.forEach(className => {
              if (className.startsWith('language-')) {
                language = className.substring(9);
              }
            });
            
            // Auto-detect language if none is specified
            if (!language) {
              // Check for Ruby
              if (codeBlock.textContent.includes('require') || 
                  codeBlock.textContent.includes('def ') ||
                  codeBlock.textContent.includes('class ') ||
                  codeBlock.textContent.includes('module ') ||
                  codeBlock.textContent.match(/\w+\s*=\s*\w+/g)) {
                language = 'ruby';
                codeBlock.classList.add('language-ruby');
              }
              // Check for SQL
              else if (codeBlock.textContent.includes('SELECT') || 
                       codeBlock.textContent.includes('FROM') ||
                       codeBlock.textContent.includes('WHERE') ||
                       codeBlock.textContent.includes('CREATE TABLE')) {
                language = 'sql';
                codeBlock.classList.add('language-sql');
              }
            }
            
            // If language is found, add it as a data attribute
            if (language) {
              highlightDiv.setAttribute('data-language', language);
            }
            
            // Create copy button
            const copyButton = document.createElement('button');
            copyButton.className = 'copy-button';
            copyButton.textContent = 'Copy';
            copyButton.setAttribute('aria-label', 'Copy code to clipboard');
            copyButton.onclick = function() {
              navigator.clipboard.writeText(codeBlock.textContent)
                .then(() => {
                  copyButton.textContent = 'Copied!';
                  copyButton.classList.add('copied');
                  setTimeout(() => {
                    copyButton.textContent = 'Copy';
                    copyButton.classList.remove('copied');
                  }, 2000);
                })
                .catch(err => {
                  console.error('Could not copy text: ', err);
                });
            };
            
            // Add copy button to the highlight div
            highlightDiv.appendChild(copyButton);
          }
        });
      }
      
      // Initialize when DOM is loaded
      document.addEventListener('DOMContentLoaded', function() {
        detectColorScheme();
        enhanceCodeBlocks();
      });
    </script>

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
  <script type="text/javascript" language="javascript" charset="utf-8">
// <![CDATA[
    addEventListener('load', function (event) {
      var agent=navigator.userAgent.toLowerCase();
      var links = document.getElementsByTagName('a');
      var regex = new RegExp('^'+window.location.protocol + '//' + window.location.hostname);

      for (var i = 0, linksLength = links.length; i < linksLength; i++) {
        if ( ! links[i].href.match(regex)) {
           links[i].setAttribute('target', '_blank');
       }
     }

    }, false);
// ]]>
</script>
</head>
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v2.5&appId=138593009602387";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
      <div class="container">
        <a class="navbar-brand py-0" href="/">
          <img class="rounded-circle" alt="ideiame logo" src="/images/ideiame.png">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarMain">
          <ul class="navbar-nav">
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle py-1" href="#" id="pagesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
               Ideia.me 
              </a>
              <ul class="dropdown-menu shadow-sm" aria-labelledby="pagesDropdown">
                <li><a class="dropdown-item" href="/archive">Archive</a></li>
                <li><a class="dropdown-item" href="/talks">Talks</a></li>
                <li><a class="dropdown-item" href="/categories">Categories</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="https://www.linkedin.com/in/jonatasdp"><i class="bi bi-linkedin"></i> Linkedin</a></li>
                <li><a class="dropdown-item" href="https://github.com/jonatas"><i class="bi bi-github"></i> Github</a></li>
                <li><a class="dropdown-item" href="https://twitter.com/jonatasdp"><i class="bi bi-twitter"></i> Twitter</a></li>
                <li><a class="dropdown-item" href="https://instagram.com/jonatasdp"><i class="bi bi-instagram"></i> Instagram</a></li>
                <li><a class="dropdown-item" href="https://www.youtube.com/user/jonatasdp"><i class="bi bi-youtube"></i> Youtube</a></li>
              </ul>
            </li>
          </ul>
          
          <div class="d-none d-md-block page-title-nav me-auto ms-2">
            Anonymize your SQL statements
          </div>
          
          <div class="form-check form-switch d-flex align-items-center ms-auto">
            <input class="form-check-input me-1" type="checkbox" id="darkModeToggle">
            <label class="form-check-label text-light" for="darkModeToggle">
              <i class="bi bi-moon-stars"></i>
            </label>
          </div>
        </div>
      </div>
    </nav>
    
    <div class="container content-container mt-5 pt-5">
      

<div class="article-wrapper">
  <div class="article-header">
    <h1>Anonymize your SQL statements</h1>
    <div class="article-meta">
      <span><i class="bi bi-calendar3"></i> November 26, 2023</span>
      <span class="separator">•</span>
      
  
  
    <span class="reading-time" title="Estimated read time">
      <i class="bi bi-clock"></i> 15 min read
    </span>
  
 
      
      
      <span class="separator">•</span>
      <span>
        <i class="bi bi-folder"></i> 
        
      </span>
      
    </div>
  </div>
  
  <div class="article-content">
    <p>As a community manager at Timescale, I frequently engage with our vibrant community, helping members tackle a variety of SQL-related challenges. One common concern that arises is the need to share SQL queries for collaboration or troubleshooting, without exposing sensitive data. Recognizing this need, I’ve embarked on developing a tool to anonymize SQL data effectively.</p>

<p>Following my previous work on a SQL formatter, this new venture focuses on SQL anonymization - transforming sensitive database identifiers into non-sensitive equivalents while retaining the query’s structure and logic.</p>

<p>In the realm of data management and privacy, anonymizing SQL data is an essential practice. Building on the capabilities of <a href="/fast-supports-sql">Fast, which now supports SQL</a>, I’m excited to share my explorations in this field.</p>

<p>Let’s take a basic SQL query as an example:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">weather_data</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span> <span class="k">ASC</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Our goal is to transform it into:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">something</span> <span class="k">FROM</span> <span class="n">somewhere</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span> <span class="k">ASC</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The anonymize here is very basic, but it can go further, replacing not just table names, but column names and all identifiers.</p>

<h2 id="understanding-ast-tokens">Understanding AST Tokens</h2>

<p>The best way to start is with a hands-on example. Here’s a SQL script that showcases a range of interconnected database objects, such as tables and views:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">"ticks"</span> <span class="p">(</span><span class="nv">"time"</span> <span class="nb">timestamp</span> <span class="k">with</span> <span class="nb">time</span> <span class="k">zone</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span> <span class="nv">"symbol"</span> <span class="nb">text</span><span class="p">,</span> <span class="nv">"price"</span> <span class="nb">decimal</span><span class="p">,</span> <span class="nv">"volume"</span> <span class="nb">float</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="n">create_hypertable</span><span class="p">(</span><span class="s1">'ticks'</span><span class="p">,</span> <span class="s1">'time'</span><span class="p">,</span> <span class="n">chunk_time_interval</span> <span class="o">=&gt;</span> <span class="n">INTERVAL</span> <span class="s1">'1 day'</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="n">MATERIALIZED</span> <span class="k">VIEW</span> <span class="n">candlestick_1m</span>
<span class="k">WITH</span> <span class="p">(</span><span class="n">timescaledb</span><span class="p">.</span><span class="n">continuous</span><span class="p">)</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="n">time_bucket</span><span class="p">(</span><span class="s1">'1m'</span><span class="p">,</span> <span class="nb">time</span><span class="p">),</span>
       <span class="nv">"ticks"</span><span class="p">.</span><span class="nv">"symbol"</span><span class="p">,</span>
       <span class="n">candlestick_agg</span><span class="p">(</span><span class="nb">time</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span> <span class="k">as</span> <span class="n">candlestick</span>
<span class="k">FROM</span> <span class="nv">"ticks"</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span>
<span class="k">WITH</span> <span class="k">DATA</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="n">MATERIALIZED</span> <span class="k">VIEW</span> <span class="n">candlestick_1h</span>
<span class="k">WITH</span> <span class="p">(</span><span class="n">timescaledb</span><span class="p">.</span><span class="n">continuous</span> <span class="p">)</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="n">time_bucket</span><span class="p">(</span><span class="s1">'1 hour'</span><span class="p">,</span> <span class="nv">"time_bucket"</span><span class="p">),</span>
       <span class="n">symbol</span><span class="p">,</span>
       <span class="k">rollup</span><span class="p">(</span><span class="n">candlestick</span><span class="p">)</span> <span class="k">as</span> <span class="n">candlestick</span> 
<span class="k">FROM</span> <span class="nv">"candlestick_1m"</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span>
<span class="k">WITH</span> <span class="k">NO</span> <span class="k">DATA</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Which should be represented with anonymized references but keep all the example
with consistent references.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">x1</span> <span class="p">(</span><span class="nv">"time"</span> <span class="nb">timestamp</span> <span class="k">with</span> <span class="nb">time</span> <span class="k">zone</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span> <span class="nv">"symbol"</span> <span class="nb">text</span><span class="p">,</span> <span class="nv">"price"</span> <span class="nb">decimal</span><span class="p">,</span> <span class="nv">"volume"</span> <span class="nb">float</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="n">create_hypertable</span><span class="p">(</span><span class="s1">'x1'</span><span class="p">,</span> <span class="s1">'time'</span><span class="p">,</span> <span class="n">chunk_time_interval</span> <span class="o">=&gt;</span> <span class="n">INTERVAL</span> <span class="s1">'1 day'</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="n">MATERIALIZED</span> <span class="k">VIEW</span> <span class="n">x3</span>
<span class="k">WITH</span> <span class="p">(</span><span class="n">timescaledb</span><span class="p">.</span><span class="n">continuous</span><span class="p">)</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="n">time_bucket</span><span class="p">(</span><span class="s1">'1m'</span><span class="p">,</span> <span class="nb">time</span><span class="p">),</span>
       <span class="n">x1</span><span class="p">.</span><span class="nv">"symbol"</span><span class="p">,</span>
       <span class="n">candlestick_agg</span><span class="p">(</span><span class="nb">time</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">volume</span><span class="p">)</span> <span class="k">as</span> <span class="n">candlestick</span>
<span class="k">FROM</span> <span class="n">x1</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span>
<span class="k">WITH</span> <span class="k">DATA</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="n">MATERIALIZED</span> <span class="k">VIEW</span> <span class="n">x5</span>
<span class="k">WITH</span> <span class="p">(</span><span class="n">timescaledb</span><span class="p">.</span><span class="n">continuous</span> <span class="p">)</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="n">time_bucket</span><span class="p">(</span><span class="s1">'1 hour'</span><span class="p">,</span> <span class="nv">"time_bucket"</span><span class="p">),</span>
       <span class="n">symbol</span><span class="p">,</span>
       <span class="k">rollup</span><span class="p">(</span><span class="n">candlestick</span><span class="p">)</span> <span class="k">as</span> <span class="n">candlestick</span>
<span class="k">FROM</span> <span class="n">x4</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span>
<span class="k">WITH</span> <span class="k">NO</span> <span class="k">DATA</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The output example is just anonymizing table names. Column names, aliases,
view names and other scenarios could also reveal business information.</p>

<p>This script presents a complex scenario with hierarchical views referencing in
cascade.</p>

<p>If you want to go deep, watch my live coding session exploring this topic.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0;"><iframe src="https://www.loom.com/embed/dd9e9e18be564907afe518024110502e?sid=dabb247f-a567-4128-b74e-a83783722322" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe></div>

<p>The short steps to cover this small scenario anonymizing table and view names are:</p>

<ol>
  <li><strong>Parsing SQL with AST</strong>: Using Fast, we begin by parsing the SQL file into an AST,
providing us with a structured format for manipulation.</li>
</ol>

<p>In this example, we use “gemfile inline” to fetch the library dynamicaly.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="nb">require</span> <span class="s1">'bundler/inline'</span>

<span class="n">gemfile</span><span class="p">(</span><span class="kp">true</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s1">'ffast'</span> <span class="c1"># , path: "../fast"</span>
  <span class="n">gem</span> <span class="s1">'pry'</span>
<span class="k">end</span>

<span class="nb">require</span> <span class="s1">'fast'</span>
<span class="nb">require</span> <span class="s1">'fast/sql'</span>

<span class="n">ast</span> <span class="o">=</span> <span class="no">Fast</span><span class="p">.</span><span class="nf">parse_sql_file</span><span class="p">(</span><span class="s1">'file.sql'</span><span class="p">)</span>

<span class="nb">binding</span><span class="p">.</span><span class="nf">pry</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Observing the entire ast structure:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
</pre></td><td class="rouge-code"><pre><span class="n">ast</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="n">s</span><span class="p">(</span><span class="ss">:create_stmt</span><span class="p">,</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:relation</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:relname</span><span class="p">,</span> <span class="s2">"ticks"</span><span class="p">),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:inh</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:relpersistence</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">)),</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:table_elts</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:column_def</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:colname</span><span class="p">,</span> <span class="s2">"time"</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:type_name</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:names</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"pg_catalog"</span><span class="p">)),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"timestamptz"</span><span class="p">))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:type_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:typemod</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:inhcount</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:is_local</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:coll_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:constraints</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:constraint</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:contype</span><span class="p">,</span> <span class="ss">:CONSTR_NOTNULL</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:old_pktable_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:column_def</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:colname</span><span class="p">,</span> <span class="s2">"symbol"</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:type_name</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:names</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:type_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:typemod</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:inhcount</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:is_local</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:coll_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:column_def</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:colname</span><span class="p">,</span> <span class="s2">"price"</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:type_name</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:names</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"pg_catalog"</span><span class="p">)),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"numeric"</span><span class="p">))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:type_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:typemod</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:inhcount</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:is_local</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:coll_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:column_def</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:colname</span><span class="p">,</span> <span class="s2">"volume"</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:type_name</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:names</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"pg_catalog"</span><span class="p">)),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"float8"</span><span class="p">))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:type_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:typemod</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:inhcount</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:is_local</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:coll_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">))),</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:oncommit</span><span class="p">,</span> <span class="ss">:ONCOMMIT_NOOP</span><span class="p">)),</span>
 <span class="n">s</span><span class="p">(</span><span class="ss">:select_stmt</span><span class="p">,</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:target_list</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:func_call</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:funcname</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"create_hypertable"</span><span class="p">))),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:args</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"ticks"</span><span class="p">))),</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"time"</span><span class="p">))),</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:named_arg_expr</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:arg</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:type_cast</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:arg</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span>
                        <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"1 day"</span><span class="p">)))),</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:type_name</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:names</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                        <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"pg_catalog"</span><span class="p">)),</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                        <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"interval"</span><span class="p">))),</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:type_oid</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:typemod</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s2">"chunk_time_interval"</span><span class="p">),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:argnumber</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:funcformat</span><span class="p">,</span> <span class="ss">:COERCE_EXPLICIT_CALL</span><span class="p">)))))),</span>
 <span class="n">s</span><span class="p">(</span><span class="ss">:create_table_as_stmt</span><span class="p">,</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:query</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:select_stmt</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:target_list</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:func_call</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcname</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"time_bucket"</span><span class="p">))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:args</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"1m"</span><span class="p">))),</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"time"</span><span class="p">))))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcformat</span><span class="p">,</span> <span class="ss">:COERCE_EXPLICIT_CALL</span><span class="p">)))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"ticks"</span><span class="p">)),</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"symbol"</span><span class="p">)))))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s2">"candlestick"</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:func_call</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcname</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"candlestick_agg"</span><span class="p">))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:args</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"time"</span><span class="p">)))),</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"price"</span><span class="p">)))),</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"volume"</span><span class="p">))))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcformat</span><span class="p">,</span> <span class="ss">:COERCE_EXPLICIT_CALL</span><span class="p">))))),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:from_clause</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:range_var</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:relname</span><span class="p">,</span> <span class="s2">"ticks"</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:inh</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:relpersistence</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">))),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:group_clause</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:sort_clause</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:sort_by</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:node</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:sortby_dir</span><span class="p">,</span> <span class="ss">:SORTBY_DEFAULT</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:sortby_nulls</span><span class="p">,</span> <span class="ss">:SORTBY_NULLS_DEFAULT</span><span class="p">))))),</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:into</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:rel</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:relname</span><span class="p">,</span> <span class="s2">"candlestick_1m"</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:inh</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:relpersistence</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">)),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:options</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:def_elem</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:defnamespace</span><span class="p">,</span> <span class="s2">"timescaledb"</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:defname</span><span class="p">,</span> <span class="s2">"continuous"</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:defaction</span><span class="p">,</span> <span class="ss">:DEFELEM_UNSPEC</span><span class="p">))),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:on_commit</span><span class="p">,</span> <span class="ss">:ONCOMMIT_NOOP</span><span class="p">)),</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:objtype</span><span class="p">,</span> <span class="ss">:OBJECT_MATVIEW</span><span class="p">)),</span>
 <span class="n">s</span><span class="p">(</span><span class="ss">:create_table_as_stmt</span><span class="p">,</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:query</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:select_stmt</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:target_list</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:func_call</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcname</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"time_bucket"</span><span class="p">))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:args</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"1 hour"</span><span class="p">))),</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"time_bucket"</span><span class="p">))))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcformat</span><span class="p">,</span> <span class="ss">:COERCE_EXPLICIT_CALL</span><span class="p">)))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"symbol"</span><span class="p">)))))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:res_target</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="s2">"candlestick"</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:val</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:func_call</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcname</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"rollup"</span><span class="p">))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:args</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:column_ref</span><span class="p">,</span>
                  <span class="n">s</span><span class="p">(</span><span class="ss">:fields</span><span class="p">,</span>
                    <span class="n">s</span><span class="p">(</span><span class="ss">:string</span><span class="p">,</span>
                      <span class="n">s</span><span class="p">(</span><span class="ss">:sval</span><span class="p">,</span> <span class="s2">"candlestick"</span><span class="p">))))),</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:funcformat</span><span class="p">,</span> <span class="ss">:COERCE_EXPLICIT_CALL</span><span class="p">))))),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:from_clause</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:range_var</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:relname</span><span class="p">,</span> <span class="s2">"candlestick_1m"</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:inh</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:relpersistence</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">))),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:group_clause</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span> <span class="mi">1</span><span class="p">))),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:sort_clause</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:sort_by</span><span class="p">,</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:node</span><span class="p">,</span>
            <span class="n">s</span><span class="p">(</span><span class="ss">:a_const</span><span class="p">,</span>
              <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span>
                <span class="n">s</span><span class="p">(</span><span class="ss">:ival</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:sortby_dir</span><span class="p">,</span> <span class="ss">:SORTBY_DEFAULT</span><span class="p">),</span>
          <span class="n">s</span><span class="p">(</span><span class="ss">:sortby_nulls</span><span class="p">,</span> <span class="ss">:SORTBY_NULLS_DEFAULT</span><span class="p">))))),</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:into</span><span class="p">,</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:rel</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:relname</span><span class="p">,</span> <span class="s2">"candlestick_1h"</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:inh</span><span class="p">,</span> <span class="kp">true</span><span class="p">),</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:relpersistence</span><span class="p">,</span> <span class="s2">"p"</span><span class="p">)),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:options</span><span class="p">,</span>
      <span class="n">s</span><span class="p">(</span><span class="ss">:def_elem</span><span class="p">,</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:defnamespace</span><span class="p">,</span> <span class="s2">"timescaledb"</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:defname</span><span class="p">,</span> <span class="s2">"continuous"</span><span class="p">),</span>
        <span class="n">s</span><span class="p">(</span><span class="ss">:defaction</span><span class="p">,</span> <span class="ss">:DEFELEM_UNSPEC</span><span class="p">))),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:on_commit</span><span class="p">,</span> <span class="ss">:ONCOMMIT_NOOP</span><span class="p">),</span>
    <span class="n">s</span><span class="p">(</span><span class="ss">:skip_data</span><span class="p">,</span> <span class="kp">true</span><span class="p">)),</span>
  <span class="n">s</span><span class="p">(</span><span class="ss">:objtype</span><span class="p">,</span> <span class="ss">:OBJECT_MATVIEW</span><span class="p">))]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li><strong>Identifying sensitive data</strong>: Use Fast to identify sensitive elements such as table names within the AST.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">relnames</span> <span class="o">=</span> <span class="no">Fast</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="s2">"(relname $_)"</span><span class="p">,</span> <span class="n">ast</span><span class="p">).</span><span class="nf">grep</span><span class="p">(</span><span class="no">String</span><span class="p">).</span><span class="nf">uniq</span>
<span class="c1"># =&gt; ["ticks", "candlestick_1m", "candlestick_1h"]</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li><strong>Anonymizing Data</strong>: We then replace these elements with generic placeholders. The anonymization process involves
replacing identified elements in the AST with ‘x’ followed by a unique number.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">pattern</span> <span class="o">=</span> <span class="s2">"{relname (sval {</span><span class="si">#{</span><span class="n">relnames</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:inspect</span><span class="p">).</span><span class="nf">join</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span><span class="si">}</span><span class="s2">})}"</span>
<span class="nb">puts</span> <span class="s2">"searching with </span><span class="si">#{</span><span class="n">pattern</span><span class="si">}</span><span class="s2">"</span>

<span class="n">content</span> <span class="o">=</span> <span class="no">Fast</span><span class="o">::</span><span class="no">SQL</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">ast</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">node</span><span class="o">|</span>
  <span class="n">new_name</span> <span class="o">=</span> <span class="n">memo</span><span class="p">[</span><span class="n">node</span><span class="p">.</span><span class="nf">source</span><span class="p">.</span><span class="nf">tr</span><span class="p">(</span><span class="sx">%|"'|</span><span class="p">,</span> <span class="s1">''</span><span class="p">)]</span> <span class="o">||=</span> <span class="s2">"x</span><span class="si">#{</span><span class="n">memo</span><span class="p">.</span><span class="nf">size</span><span class="si">}</span><span class="s2">"</span>
  <span class="n">new_name</span> <span class="o">=</span> <span class="s2">"'</span><span class="si">#{</span><span class="n">new_name</span><span class="si">}</span><span class="s2">'"</span> <span class="k">if</span> <span class="n">node</span><span class="p">.</span><span class="nf">type</span> <span class="o">==</span> <span class="ss">:sval</span>
  <span class="n">replace</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="nf">loc</span><span class="p">.</span><span class="nf">expression</span><span class="p">,</span> <span class="n">new_name</span><span class="p">)</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ol>
  <li><strong>Visualizing Changes</strong>: <code class="language-plaintext highlighter-rouge">Fast.highlight</code> is employed to color-code and display the changes for better understanding.</li>
</ol>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">puts</span> <span class="no">Fast</span><span class="p">.</span><span class="nf">highlight</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="ss">sql: </span><span class="kp">true</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The complete <code class="language-plaintext highlighter-rouge">Fastfile</code> is <a href="https://github.com/jonatas/fast/blob/ccde22cdfa7f7fa910fcfec54d4691250b18d48b/Fastfile#L118-L137">here</a>.</p>

<p>Transform sensitive SQL data into anonymized &amp; shareable code allow community to
bring more complex scenarios closer to production using such idea.</p>

<p>It can also serve as a third eye to see the data structures from a blind spot.
Allowing you to understand standards that repeats over different business
models.</p>

<p>Small shortcuts can also be introduced into your security culture and enables safe sharing of SQL queries within the community.</p>

<p>The power and flexibility of using AST and Fast for anonymizing SQL data open up new horizons in data privacy and security 🫶</p>

<p>I encourage you to experiment with the code and adapt it to your specific needs. If you have questions or insights, feel free to reach out. For more insights into manipulating SQL with Fast, revisit my <a href="https://ideia.me/building-a-sql-formatter-with-fast">previous post on building a SQL formatter</a>.</p>


  </div>
  
  
  <div class="article-tags">
    
  </div>
  
  
  
<div class="social-sharing mb-4">
  <h5>Share this article</h5>
  <div class="sharing-buttons">
    
    <a href="https://twitter.com/intent/tweet?text=Anonymize+your+SQL+statements&url=https%3A%2F%2Fideia.me%2Fanonymizing-your-sql&via=jonatasdp" 
       class="btn btn-twitter btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-twitter"></i> Twitter
    </a>
    
    
    
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fideia.me%2Fanonymizing-your-sql" 
       class="btn btn-facebook btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-facebook"></i> Facebook
    </a>
    
    
    
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fideia.me%2Fanonymizing-your-sql&title=Anonymize+your+SQL+statements" 
       class="btn btn-linkedin btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-linkedin"></i> LinkedIn
    </a>
    
    
    
    <a href="https://reddit.com/submit?url=https%3A%2F%2Fideia.me%2Fanonymizing-your-sql&title=Anonymize+your+SQL+statements" 
       class="btn btn-reddit btn-sm" 
       target="_blank"
       rel="noopener noreferrer">
      <i class="bi bi-reddit"></i> Reddit
    </a>
    
  </div>
</div>
 
  <div class="author-bio">
  <img src="/images/jonatas-davi-paganini-profile-2025.png" alt="Jônatas Davi Paganini">
  <div class="author-bio-content">
    <h4>Jônatas Davi Paganini</h4>
    <p>Developer and writer passionate about PostgreSQL, TimescaleDB, and building better systems. Currently sharing knowledge about time series databases and system architecture.</p>
    <div class="author-social">
      <a href="https://github.com/jonatas" target="_blank" title="GitHub"><i class="bi bi-github"></i></a>
      <a href="https://twitter.com/jonatasdp" target="_blank" title="Twitter"><i class="bi bi-twitter"></i></a>
      <a href="https://linkedin.com/in/jonatasdp" target="_blank" title="LinkedIn"><i class="bi bi-linkedin"></i></a>
      
      <a href="https://instagram.com/jonatasdp" target="_blank" title="Instagram"><i class="bi bi-instagram"></i></a>
      
    </div>
  </div>
</div> 
  <div class="content-nav">
  <div class="content-nav-previous">
    
      <small>Previous</small>
      <a href="/building-a-sql-formatter-with-fast" title="Building a SQL formatter with Fast">
        Building a SQL formatter with Fast
      </a>
    
  </div>
  
  <div class="content-nav-next">
    
      <small>Next</small>
      <a href="/customize-multiple-refreshes-continuous-aggregates" title="Customize multiple refreshes for continuous aggregates">
        Customize multiple refreshes for continuous agg...
      </a>
    
  </div>
</div> 
  
<div class="related-posts">
  <div class="card">
    <div class="card-header">
      <h4>Related Articles</h4>
    </div>
    <div class="card-body">
      <div class="row">
        
        
        
        
        
          
            
              
              
                
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
              
              
            
          
          
          
        
          
            
              
              
                
              
                
              
                
              
              
              
            
          
          
          
            
        
        
        
        
        
        
        
          <div class="col-12">
            <p>No related posts found. Check out <a href="/archive.html">recent posts</a> instead.</p>
          </div>
        
      </div>
    </div>
  </div>
</div>
 
  <div class="comments-section card mb-4">
  <div class="card-header">
    <h4>Comments</h4>
  </div>
  <div class="card-body">
    <div id="disqus_thread"></div>
    <script>
      /**
      *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
      *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
      
      var disqus_config = function () {
        this.page.url = "https://ideia.me/anonymizing-your-sql";
        this.page.identifier = "/anonymizing-your-sql";
      };
      
      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://ideiame.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</div> 
</div>

<link rel="stylesheet" href="/css/enhanced.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">


    </div>
    
    <footer class="footer bg-light py-4 mt-5">
      <div class="container text-center">
        <p class="text-muted mb-0">© 2025 Jônatas Davi Paganini. All rights reserved.</p>
      </div>
    </footer>

    <!-- Additional scripts for code highlighting and dark mode toggle -->
    <script>
      // Toggle dark mode manually with smoother transition
      document.getElementById('darkModeToggle').addEventListener('change', function() {
        // Add transition class before changing mode
        document.body.classList.add('theme-transition');
        
        if (this.checked) {
          document.body.classList.add('dark-mode');
        } else {
          document.body.classList.remove('dark-mode');
        }
        
        // Remove transition class after transition completes
        setTimeout(() => {
          document.body.classList.remove('theme-transition');
        }, 500);
      });
      
      // Apply highlighting to code blocks after content loads
      document.addEventListener('DOMContentLoaded', function() {
        enhanceCodeBlocks();
        if (window.Prism) {
          setTimeout(function() {
            Prism.highlightAll();
          }, 100);
        }
      });
      
      // Reapply highlighting after any AJAX content loads
      document.addEventListener('ajaxComplete', function() {
        enhanceCodeBlocks();
        if (window.Prism) {
          setTimeout(function() {
            Prism.highlightAll();
          }, 100);
        }
      });
    </script>

    <!-- SEO and content improvement scripts -->
    <script src="/assets/js/seo-helper.js"></script>
    <script src="/assets/js/category-standardizer.js"></script>
    <script src="/assets/js/link-validator.js"></script>

    <!-- Add this at the end of the body, just before closing body tag -->
    <script>
      // Scroll animation for fade-in elements - modified to be more selective
      document.addEventListener('DOMContentLoaded', function() {
        const fadeElements = document.querySelectorAll('.fade-in');
        
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
            }
          });
        }, {
          threshold: 0.1
        });
        
        fadeElements.forEach(element => {
          observer.observe(element);
        });
        
        // Only apply fade-in to non-critical UI elements
        // Avoid applying to main content or navigation elements
        const animateElements = document.querySelectorAll('.card:not(.latest-post-card):not(.post-content), .featured-content .card, .post-list-group .list-group-item');
        animateElements.forEach((element, index) => {
          // Add minimal delay to reduce blinking effect
          element.classList.add('fade-in');
          element.style.transitionDelay = `${index * 0.02}s`; // Reduced delay
        });
        
        // Copy code button functionality
        const codeBlocks = document.querySelectorAll('pre');
        codeBlocks.forEach((block) => {
          if (!block.querySelector('.copy-button')) {
            const button = document.createElement('button');
            button.className = 'copy-button';
            button.textContent = 'Copy';
            
            button.addEventListener('click', () => {
              const code = block.querySelector('code').textContent;
              navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                  button.textContent = 'Copy';
                  button.classList.remove('copied');
                }, 2000);
              });
            });
            
            block.appendChild(button);
          }
        });
      });
    </script>

    <!-- Ensure smooth page transitions -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Add fade-in class to the main content container
        const contentContainer = document.querySelector('.content-container');
        if (contentContainer) {
          // Set initial opacity
          contentContainer.style.opacity = '0';
          
          // Fade in the content
          setTimeout(() => {
            contentContainer.style.transition = 'opacity 0.3s ease';
            contentContainer.style.opacity = '1';
          }, 50);
        }
        
        // Handle page navigation with smooth transitions
        document.querySelectorAll('a').forEach(link => {
          // Only apply to internal links
          if (link.hostname === window.location.hostname && !link.hasAttribute('target')) {
            link.addEventListener('click', function(e) {
              // Don't apply to download links or anchor links
              if (link.hasAttribute('download') || link.getAttribute('href').startsWith('#')) {
                return;
              }
              
              e.preventDefault();
              const destination = link.href;
              
              // Fade out
              if (contentContainer) {
                contentContainer.style.opacity = '0';
              }
              
              // Navigate after a short delay
              setTimeout(() => {
                window.location.href = destination;
              }, 300);
            });
          }
        });
      });
    </script>
    <!-- Profile image swap functionality -->
    <script src="/js/profile-image-swap.js"></script>
  </body>
</html>

